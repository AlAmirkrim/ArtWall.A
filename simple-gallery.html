<!-- simple-gallery.html -->
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¹Ø±Ø¶ ØµÙˆØ± Ø¨Ø³ÙŠØ·</title>
    <link rel="stylesheet" href="unified-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
    <script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
    <script src="imageData.js"></script>
    <script src="shared-image-utilities.js"></script>
    <script src="ImageDownloader.js"></script>
    <script src="language-functions.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a0b20;
            color: white;
            margin: 0;
            padding: 0;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
        .site-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(13, 0, 13, 0.95);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            padding: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .header-left {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1002;
            width: auto;
        }
        
        .header-right {
            position: fixed;
            right: 15px;
            top: 10px;
            z-index: 1005;
        }
        
        .site-logo-container {
            display: flex;
            align-items: center;
            height: 100%;
            direction: ltr;
        }
        
        .header-logo-small {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 8px;
            object-fit: cover;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .site-name-small {
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 1px;
            margin: 0;
            padding: 0;
            background: linear-gradient(45deg, #b14cc8, #4CAF50, #00e6ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .site-name-small:hover {
            transform: scale(1.05);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .menu-toggle {
            background: rgba(64, 16, 75, 0.7);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .menu-toggle:hover {
            background: rgba(84, 21, 100, 0.9);
        }
        
        .menu-toggle i {
            color: white;
            font-size: 1.2rem;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar {
            width: 220px; /* ØªØµØºÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† 240px Ø¥Ù„Ù‰ 220px */
            height: 100vh;
            background: rgba(13, 0, 13, 0.95);
            position: fixed;
            left: -255px; /* ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
            top: 0;
            padding-top: 70px;
            padding-left: 1rem; /* ØªÙ‚Ù„ÙŠÙ„ padding Ù…Ù† 1.2rem Ø¥Ù„Ù‰ 1rem */
            padding-right: 1rem;
            padding-bottom: 2rem;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            z-index: 900;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            overflow-y: auto;
            overflow-x: hidden;
            /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            scrollbar-width: none; /* Ù„Ù…ØªØµÙØ­Ø§Øª Firefox */
            -ms-overflow-style: none; /* Ù„Ù…ØªØµÙØ­Ø§Øª Edge/IE */
            /* Ø¶Ù…Ø§Ù† Ø«Ø¨Ø§Øª Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§Ù„Ù„ØºØ© */
            direction: ltr;
        }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù…ØªØµÙØ­Ø§Øª WebKit (Chrome, Safari) */
        .sidebar::-webkit-scrollbar {
            width: 0;
            display: none;
        }
        
        /* Ø¶Ø¨Ø· Ø§ØªØ¬Ø§Ù‡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© */
        html[dir="rtl"] .sidebar .account-section {
            text-align: right;
        }
        
        html[dir="ltr"] .sidebar .account-section {
            text-align: left;
        }
        
        .sidebar.active {
            left: 0;
            transform: translateX(0);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .sidebar {
                left: -260px; /* ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ù„ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
                transform: translateX(-100%);
                width: 230px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† 250px Ø¥Ù„Ù‰ 230px */
                z-index: 900;
            }
            
            .sidebar.active {
                left: 0;
                transform: translateX(0);
            }
            
            .header-right {
                right: 10px;
            }
            
            .site-name-small {
                font-size: 1.1rem;
            }
            
            .header-logo-small {
                width: 32px;
                height: 32px;
            }
        }
        
        @media (max-width: 480px) {
            .header-right {
                right: 5px;
            }
            
            .site-name-small {
                font-size: 1rem;
            }
            
            .header-logo-small {
                width: 28px;
                height: 28px;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ù‹Ø§ */
            .site-header {
                padding: 5px 10px;
                height: 55px;
            }
            
            .filters-container {
                top: 55px;
                padding: 5px 0;
            }
            
            .filters {
                padding: 6px 10px;
                max-width: 98%;
                border-radius: 20px;
                margin-bottom: 10px;
            }
            
            .filter-btn {
                padding: 5px 10px;
                font-size: 13px;
            }
            
            .language-switcher {
                top: 10px;
                padding: 3px 8px;
            }
            
            .dimensions-buttons {
                justify-content: space-around;
            }
            
            /* ØªØµØºÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .view-mode-btn {
                width: 40px;
                height: 40px;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
            .search-container {
                margin: 8px auto;
                max-width: 70%;
                width: 65%;
            }
            
            /* ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø«Ø§Ù†ÙŠ */
            body.wide-view .grid-item {
                max-width: 92%;
                margin: 0 auto 15px;
                transform: scale(0.92);
                transform-origin: top center;
            }
            
            body.wide-view .grid-item img {
                max-width: 100%;
                height: auto;
            }
            
            html[dir="rtl"] .search-input {
                padding: 5px 8px 5px 25px;
                font-size: 11px;
                height: 28px;
            }
            
            html[dir="ltr"] .search-input {
                padding: 5px 25px 5px 8px;
                font-size: 11px;
                height: 28px;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙÙŠ Ø§Ù„ØµÙˆØ± */
            .action-btn {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .logo-section {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .sidebar-logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 10px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ */
        .account-section {
            margin-bottom: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        }
        
        .account-section h3 {
            font-size: 1.1rem; /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· */
            color: #b14cc8;
            margin-bottom: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© */
            padding-bottom: 4px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© Ù„Ù„Ø®Ø· */
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ */
        .auth-btn {
            background-color: rgba(58, 16, 69, 0.5);
            color: white;
            border: none;
            padding: 8px 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
            border-radius: 5px;
            margin-bottom: 8px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            text-align: right;
            display: flex;
            align-items: center;
            font-size: 0.95rem; /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
        }
        
        .auth-btn:hover {
            background-color: rgba(177, 76, 200, 0.7);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ± */
        .dimensions-section {
            margin-top: 10px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
            margin-bottom: 10px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø£Ø³ÙÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        }
        
        .dimensions-title {
            font-size: 1rem; /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
            color: #b14cc8;
            margin-bottom: 6px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ */
        }
        
        /* Ù†Ù…Ø· Ù„Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙØ§Ø±ØºØ© Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .sidebar-spacer {
            height: 150px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙØ§Ø±ØºØ© Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ù„Ø¨ */
            padding-top: 10px;
            margin-top: 15px;
            padding-bottom: 50px; /* Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø­Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ø£Ø³ÙÙ„ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            position: relative;
            /* Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± ØªÙ„Ø§Ø´ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ© */
            background: linear-gradient(to bottom, rgba(13, 0, 13, 0.95), transparent);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ù„Ø¨ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .heart-icon {
            position: absolute;
            bottom: 25px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„ */
            left: 50%;
            transform: translateX(-50%);
            color: #b14cc8;
            font-size: 26px; /* Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
            opacity: 0.8;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
            z-index: 10; /* ØªØ£ÙƒÙŠØ¯ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙÙˆÙ‚ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø®Ø±Ù‰ */
            pointer-events: auto; /* ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
        }
        
        .heart-icon:hover {
            opacity: 1;
            transform: translateX(-50%) scale(1.2);
            color: #ff4e8a;
        }
        
        .dimensions-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 6px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        }
        
        .dimension-btn {
            background-color: rgba(58, 16, 69, 0.5);
            border: none;
            border-radius: 8px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.3s;
            width: 60px;  /* Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£ØµÙ„ÙŠ */
            height: 60px; /* Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£ØµÙ„ÙŠ */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        }

        .dimension-btn.dimension-btn3 {
            background-color: rgba(58, 16, 69, 0.5);
            border: none;
            border-radius: 8px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.3s;
            width: 35px;  /* Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£ØµÙ„ÙŠ */
            height: 60px; /* Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£ØµÙ„ÙŠ */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        }
        
        .dimension-btn:hover {
            background-color: rgba(177, 76, 200, 0.7);
            transform: translateY(-2px);
        }
        
        .dimension-btn.active {
            background-color: #b14cc8;
            box-shadow: 0 0 10px rgba(177, 76, 200, 0.7);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø§Ù… Ù„Ù„ØµÙˆØ± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .dimension-btn img {
            width: 99%;
            height: 99%;
            object-fit: contain;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ø²Ø± Ø§Ù„Ù€ All (Ø¬Ø¹Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙƒØ¨Ø±) */
        .dimension-btn.dimension-btn-all img {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            display: block;
            max-width: 54px;
            height: auto;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø§Ù„Ø£Ø®Ø±Ù‰ */
        .dimension-btn:not(.dimension-btn-all) img {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: block;
            max-width: 32px;
            height: auto;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ */
        .view-mode-btn {
            background-color: rgba(58, 16, 69, 0.5);
            border: none;
            border-radius: 8px;
            padding: 5px;
            cursor: pointer;
            transition: all 0.3s;
            width: 60px;  /* ØªØ¹Ø¯ÙŠÙ„ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ */
            height: 60px; /* ØªØ¹Ø¯ÙŠÙ„ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px;
            font-size: 1.2rem; /* Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
        }
        
        .view-mode-btn:hover {
            background-color: rgba(177, 76, 200, 0.7);
            transform: translateY(-2px);
        }
        
        .view-mode-btn.active {
            background-color: #b14cc8;
            box-shadow: 0 0 10px rgba(177, 76, 200, 0.7);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content {
            padding-top: 80px;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù…Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        @media (min-width: 1200px) {
            .main-content {
                margin-left: 260px; /* Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© + Ù…Ø³Ø§ÙØ© 30px */
                width: calc(100% - 235px);
                padding-left: 0; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ */
            }
            
            body.sidebar-expanded .main-content {
                margin-left: 245px;
            }
            
            /* ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ± */
            .gallery-container {
                padding-left: 25px; /* Ù…Ø³Ø§ÙØ© Ø£ÙƒØ¨Ø± Ù…Ù† gutter-sizer */
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø­Ø¬Ù… */
        @media (min-width: 768px) and (max-width: 1199px) {
            .main-content {
                padding-top: 85px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
            }
            
            .gallery-container {
                padding-left: 35px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± */
                padding-right: 35px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
            }
            
            body.sidebar-expanded .main-content {
                margin-left: 40px; /* Ù…Ø³Ø§ÙØ© Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ù…ÙØªÙˆØ­Ø© */
            }
        }
        
        .gallery-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ø±Ø¶ */
        .masonry-grid {
            width: 100%;
        }
        
        .grid-sizer,
        .grid-item {
            width: calc(33.333% - 10px);
            margin-bottom: 15px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª CSS Ù…ØªØºÙŠØ±Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶ ÙˆÙÙ‚ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª */
        :root {
            --grid-columns: 3;
            --medium-columns: 2;
            --small-columns: 1;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© - Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ© (769px - 1199px) */
        @media (min-width: 769px) and (max-width: 1199px) {
            /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: Ø¹Ù…ÙˆØ¯Ø§Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Masonry */
            .grid-sizer,
            .grid-item {
                width: calc(50% - 10px);
                margin-bottom: 15px;
            }
            
            /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶: Ø«Ù„Ø§Ø«Ø© Ø£Ø¹Ù…Ø¯Ø© */
            body.wide-view .grid-sizer,
            body.wide-view .grid-item {
                width: calc(33.33% - 10px);
            }
        }
        
        @media (max-width: 768px) {
            .grid-sizer,
            .grid-item {
                width: calc((100% / var(--medium-columns)) - 7.5px) !important;
            }
            
            .gallery-container {
                padding: 0 10px;
            }
            
            .gutter-sizer {
                width: 10px;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ù‡ÙˆØ§Ù…Ø´ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ø±Ø¶ */
            .image-card {
                margin-bottom: 12px;
            }
            
            /* ØªÙ‚Ù„ÙŠØµ Ø­Ø¬Ù… Ù†Øµ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
            .image-title-badge {
                max-width: 120px;
                font-size: 11px;
            }
            
            /* ØªØµØºÙŠØ± Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© */
            .action-btn {
                width: 32px;
                height: 32px;
            }
        }
        
        @media (max-width: 480px) {
            .grid-sizer,
            .grid-item {
                width: calc((100% / var(--small-columns)) - 5px) !important;
            }
            
            /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            body.wide-view .grid-sizer {
                width: 50% !important;
            }
            
            body.wide-view .grid-item {
                width: calc(50% - 5px) !important;
                float: left !important;
                margin-right: 5px;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© - Ø¹Ù…ÙˆØ¯ÙŠÙ† */
            body.wide-mobile-view .masonry-grid {
                display: block !important;
                column-count: 2 !important;
                column-gap: 6px !important;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            body.wide-mobile-view .image-card {
                display: inline-block !important;
                width: 100% !important;
                margin-bottom: 6px !important;
                break-inside: avoid !important;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù†Ø§ØµØ± Grid Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            body.wide-mobile-view .grid-item {
                width: 100% !important;
                margin: 0 0 6px 0 !important;
                break-inside: avoid !important;
            }
            
            /* ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªØ¯ÙÙ‚ Ø¨Ø¹Ø¯ ÙƒÙ„ Ø²ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
            body.wide-mobile-view .grid-item:nth-child(2n)::after,
            body.wide-view .grid-item:nth-child(2n)::after {
                content: "";
                display: table;
                clear: both;
            }
            
            /* ÙØ¦Ø© Ø®Ø§ØµØ© Ù„Ù„Ø´Ø¨ÙƒØ© ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ */
            .wide-grid {
                display: flex !important;
                flex-wrap: wrap !important;
                width: 100% !important;
            }
            
            .gallery-container {
                padding: 0 8px;
            }
            
            .image-card {
                margin-bottom: 15px;
                width: 100%;
                display: block;
                break-inside: avoid;
            }
            
            /* Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            body.wide-view .image-card,
            body.wide-mobile-view .image-card {
                margin-bottom: 6px;
                height: auto; /* Ø¥ØµÙ„Ø§Ø­ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ØµÙˆØ± */
            }
            
            /* Ø¬Ø¹Ù„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³ÙÙ„ÙŠØ© Ø¸Ø§Ù‡Ø±Ø© Ø¯Ø§Ø¦Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„ØµØºÙŠØ±Ø© */
            .bottom-actions {
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… ÙˆØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .action-btn {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø´Ø§Ø±Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .image-header {
                top: 5px;
                right: 5px;
                gap: 3px;
            }
            
            .category-badge {
                font-size: 10px;
                padding: 3px 6px;
            }
            
            .image-title-badge {
                font-size: 10px;
                padding: 3px 6px;
                max-width: 100px;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .image-card:hover {
                transform: translateY(-2px);
            }
            
            /* ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆØ´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .filters {
                padding: 8px 12px;
                border-radius: 20px;
                max-width: 95%;
                gap: 6px;
            }
            
            .filter-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
        }
        
        .gutter-sizer {
            width: 15px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ± */
        .image-card {
            border-radius: 8px;
            overflow: hidden;
            background-color: #2a0a30;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            position: relative;
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .image-card:hover {
            transform: translateY(-5px);
        }
        
        .gallery-image {
            width: 100%;
            display: block;
            object-fit: cover; /* ØªØ£ÙƒØ¯ Ù…Ù† ØªØºØ·ÙŠØ© Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ */
            height: calc(100% - 10px); /* Ø¶Ø¨Ø· Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„ÙØ§Ø±ØºØ© */
            min-height: 150px; /* Ø­Ø¯ Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø§Ø±ØªÙØ§Ø¹ */
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙˆØ±Ø© */
        .image-header {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 5;
        }
        
        .category-badge {
            background-color: rgba(177, 76, 200, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
            backdrop-filter: blur(2px);
        }
        
        .image-title-badge {
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
            backdrop-filter: blur(2px);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙŠ ÙŠØ³Ø§Ø± Ø§Ù„ØµÙˆØ±Ø© */
        .left-actions {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 5px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª */
            z-index: 5;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙŠ Ø£Ø³ÙÙ„ Ø§Ù„ØµÙˆØ±Ø© - Ù…Ø®ÙÙŠØ© ÙˆØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ */
        .bottom-actions {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            z-index: 5;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            border-radius: 20px;
        }
        
        .image-card:hover .bottom-actions {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµÙˆØ±Ø© */
        .action-btn {
            background-color: rgba(58, 16, 69, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(2px);
        }
        
        .action-btn:hover {
            background-color: #b14cc8;
            transform: scale(1.1);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ */
        .action-btn.like-btn .fa-heart {
            color: transparent;
            -webkit-text-stroke: 1px white;
            transition: all 0.3s;
        }
        
        .action-btn.like-btn.active .fa-heart {
            color: white;
            -webkit-text-stroke: 0;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø© */
        .action-btn.favorite-btn .fa-bookmark {
            color: transparent;
            -webkit-text-stroke: 1px white;
            transition: all 0.3s;
        }
        
        .action-btn.favorite-btn.active .fa-bookmark {
            color: white;
            -webkit-text-stroke: 0;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª */
        .like-count {
            font-size: 10px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border-radius: 10px;
            padding: 2px 5px;
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            min-width: 20px;
            text-align: center;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ */
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ */
        .view-mode-btn {
            background-color: rgba(58, 16, 69, 0.5);
            border: none;
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px;
            font-size: 18px;
            color: white;
        }
        
        .view-mode-btn:hover {
            background-color: rgba(177, 76, 200, 0.7);
            transform: translateY(-2px);
        }
        
        .view-mode-btn.active {
            background-color: #b14cc8;
            box-shadow: 0 0 10px rgba(177, 76, 200, 0.7);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„ØªØ±Ø© */
        .filters-container {
            position: sticky;
            top: 70px;
            z-index: 800;
            padding: 10px 0;
            background-color: transparent;
            width: 100%;
            display: flex;
            justify-content: center;
        }
        
        .filters {
            display: flex;
            flex-wrap: nowrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 15px;
            overflow-x: auto;
            white-space: nowrap;
            scrollbar-width: none; /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Firefox */
            background-color: rgba(13, 0, 13, 0.9);
            border-radius: 30px;
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            -ms-overflow-style: none; /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ IE Ùˆ Edge */
        }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Chrome Ùˆ Safari Ùˆ Opera */
        .filters::-webkit-scrollbar {
            display: none;
        }
        
        .filters::-webkit-scrollbar {
            height: 5px;
        }
        
        .filters::-webkit-scrollbar-track {
            background: rgba(26, 11, 32, 0.5);
            border-radius: 10px;
        }
        
        .filters::-webkit-scrollbar-thumb {
            background-color: #b14cc8;
            border-radius: 10px;
        }
        
        .filter-btn {
            background-color: #3a1045;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            flex-shrink: 0;
            font-weight: 500;
            min-width: fit-content;
        }
        
        .filter-btn:hover {
            background-color: #b14cc8;
            transform: translateY(-2px);
        }
        
        .filter-btn.active {
            background-color: #b14cc8;
            box-shadow: 0 0 8px #b14cc8;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø§Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù…Ù„ */
        .fullscreen-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        
        .viewer-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }
        
        .viewer-image {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }
        
        .viewer-title {
            text-align: center;
            margin-top: 15px;
            font-size: 18px;
        }
        
        .close-btn {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .language-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }
        
        .sidebar-lang-btn {
            display: flex;
            align-items: center;
            background-color: rgba(58, 16, 69, 0.5);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            text-align: right;
        }
        
        .sidebar-lang-btn:hover {
            background-color: rgba(177, 76, 200, 0.7);
            transform: translateY(-2px);
        }
        
        .sidebar-lang-btn.active {
            background-color: #b14cc8;
            box-shadow: 0 0 10px rgba(177, 76, 200, 0.7);
        }
        
        .lang-icon {
            font-size: 18px;
            margin-right: 8px;
        }
        
        .lang-name {
            flex: 1;
            text-align: right;
            white-space: nowrap;
        }
        
        html[dir="ltr"] .sidebar-lang-btn {
            text-align: left;
        }
        
        html[dir="ltr"] .lang-name {
            text-align: left;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */
        .search-container {
            position: relative;
            margin: 15px auto;
            max-width: 450px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶ Ù„Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ø²Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
            width: 80%;
            display: flex;
            align-items: center;
            gap: 10px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù„ØºØ© */
        .search-input {
            flex: 1; /* Ø¬Ø¹Ù„ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« ÙŠØ£Ø®Ø° Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© */
            background-color: rgba(26, 11, 32, 0.7);
            border: 1px solid rgba(177, 76, 200, 0.5);
            border-radius: 25px;
            color: white;
            font-size: 13px;
            transition: all 0.3s;
            outline: none;
        }
        
        html[dir="rtl"] .search-input {
            padding: 10px 15px 10px 40px;
            text-align: right;
        }
        
        html[dir="ltr"] .search-input {
            padding: 10px 40px 10px 15px;
            text-align: left;
        }
        
        .search-input:focus {
            background-color: rgba(45, 20, 55, 0.9);
            border-color: #b14cc8;
            box-shadow: 0 0 10px rgba(177, 76, 200, 0.5);
        }
        
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* ØªÙ…ÙˆØ¶Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù„ØºØ© */
        html[dir="rtl"] .search-icon {
            position: absolute;
            top: 50%;
            left: 15px;
            right: auto;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
            pointer-events: none;
        }
        
        html[dir="ltr"] .search-icon {
            position: absolute;
            top: 50%;
            right: 15px;
            left: auto;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
            pointer-events: none;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª */
        .filter-toggle-btn {
            background: linear-gradient(135deg, rgba(177, 76, 200, 0.8), rgba(0, 230, 255, 0.6));
            border: 1px solid rgba(177, 76, 200, 0.5);
            border-radius: 25px;
            color: white;
            padding: 8px 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            min-width: 80px;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .filter-toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, rgba(177, 76, 200, 1), rgba(0, 230, 255, 0.8));
        }
        
        .filter-toggle-btn.active {
            background: linear-gradient(135deg, rgba(177, 76, 200, 1), rgba(0, 230, 255, 0.8));
            border-color: rgba(177, 76, 200, 0.8);
        }
        
        .filter-toggle-btn.inactive {
            background: linear-gradient(135deg, rgba(100, 100, 100, 0.6), rgba(60, 60, 60, 0.8));
            border-color: rgba(100, 100, 100, 0.5);
            opacity: 0.7;
        }
        
        .filter-toggle-btn.inactive:hover {
            background: linear-gradient(135deg, rgba(120, 120, 120, 0.8), rgba(80, 80, 80, 1));
        }
        
        .filter-toggle-btn i {
            font-size: 13px;
        }
        
        .filter-status-text {
            font-weight: 500;
            font-size: 11px;
        }
        
        /* ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª */
        .search-container.unlinked .search-input {
            border-color: rgba(255, 165, 0, 0.7);
            box-shadow: 0 0 5px rgba(255, 165, 0, 0.3);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø§Ù„Ù…Ø£Ø®ÙˆØ°Ø© Ù…Ù† index.html */
        .sidebar-tools {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .language-dropdown {
            position: relative;
            display: block;
            width: 100%;
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø²Ø± Ø§Ù„Ù„ØºØ© - Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø­Ø³Ù† ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .lang-switcher-new {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            background: linear-gradient(135deg, rgba(177, 76, 200, 0.7), rgba(0, 230, 255, 0.5));
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            text-decoration: none;
            box-sizing: border-box;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-weight: 500;
            width: 100%;
            justify-content: space-between;
        }
        
        .lang-switcher-new:hover {
            background: linear-gradient(135deg, rgba(177, 76, 200, 0.9), rgba(0, 230, 255, 0.7));
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .lang-switcher-new:active {
            transform: translateY(1px);
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
        }
        
        .lang-icon {
            font-size: 1.1em;
            margin-right: 6px;
        }
        
        html[dir="rtl"] .lang-icon {
            margin-right: 0;
            margin-left: 6px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø³Ù‡Ù… ÙÙŠ Ø²Ø± Ø§Ù„Ù„ØºØ© - Ù…Ø­Ø³Ù† */
        .down-arrow {
            display: inline-block;
            margin-left: 6px;
            font-size: 0.8em;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø³Ù‡Ù… Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .language-dropdown.open .down-arrow {
            transform: rotate(180deg);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„ØºØ© - Ù…ÙˆØ­Ø¯ Ù…Ø¹ ØªØµÙ…ÙŠÙ… index.html */
        .language-dropdown-content {
            position: absolute;
            top: 100% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            display: none; /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            width: 200px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
            max-width: 200px; /* Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ø±Ø¶ */
            background: rgba(26, 11, 32, 0.98);
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5), 0 3px 10px rgba(177, 76, 200, 0.3);
            z-index: 9999;
            border: 2px solid rgba(177, 76, 200, 0.5);
            padding: 0;
            overflow: visible;
            /* Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ø¨Ø± JavaScript */
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
            will-change: transform, opacity;
        }
        
        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¸Ù‡ÙˆØ± Ù…Ù† Ø£Ø³ÙÙ„ */
        @keyframes fadeInFromBottom {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¸Ù‡ÙˆØ± Ù…Ù† Ø£Ø¹Ù„Ù‰ */
        @keyframes fadeInFromTop {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ØªØ­Ø±Ùƒ ÙˆØ±Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡Ø§ */
        .language-dropdown-content.show {
            display: block !important; /* Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© */
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© - Ù…Ø­Ø³Ù† */
        .language-dropdown-content a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            font-size: 0.9rem;
            border-bottom: 1px solid rgba(177, 76, 200, 0.2);
            letter-spacing: 0.3px;
            width: 100%; /* Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø«Ø§Ø¨Øª */
            direction: ltr; /* ØªØ«Ø¨ÙŠØª Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Øµ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© */
            justify-content: flex-start; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø«Ø§Ø¨ØªØ© */
            text-align: left; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ù†Øµ Ø«Ø§Ø¨ØªØ© */
        }
        
        .language-dropdown-content a:last-child {
            border-bottom: none;
        }
        
        .language-dropdown-content a:hover {
            background-color: rgba(177, 76, 200, 0.3);
            padding-left: 18px;
            letter-spacing: 0.5px;
        }
        
        .language-dropdown-content a.active {
            background-color: rgba(177, 76, 200, 0.5);
            font-weight: bold;
        }
        
        .language-dropdown-content a::before {
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .language-dropdown-content a[data-lang="ar"]::before {
            content: 'ğŸ‡¸ğŸ‡¦';
        }
        
        .language-dropdown-content a[data-lang="en"]::before {
            content: 'ğŸ‡ºğŸ‡¸';
        }
        
        .language-dropdown-content a[data-lang="fr"]::before {
            content: 'ğŸ‡«ğŸ‡·';
            margin-right: 10px;
        }
        
        .language-dropdown-content a[data-lang="es"]::before {
            content: 'ğŸ‡ªğŸ‡¸';
            margin-right: 10px;
        }
        
        .language-dropdown-content a.active::after {
            content: 'âœ“';
            position: absolute;
            right: 15px;
            color: #4CAF50;
            font-weight: bold;
        }
        
        /* ØªØ«Ø¨ÙŠØª Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ¹Ù„Ø§Ù…Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù„ØºØ© */
        html[dir="rtl"] .language-dropdown-content a::before {
            margin-right: 10px;
            margin-left: 0;
        }
        
        html[dir="rtl"] .language-dropdown-content a.active::after {
            right: 15px;
            left: auto;
        }
        
        html[dir="rtl"] .language-dropdown-content {
            right: auto;
            left: 0; /* Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
            text-align: left; /* ØªØ«Ø¨ÙŠØª Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ù†Øµ */
        }
        
        html[dir="rtl"] .language-dropdown-content a:hover {
            padding-left: 18px;
            padding-right: 15px;
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ÙØ¦Ø§Øª */
        .category-icon {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.2em;
            vertical-align: middle;
            color: white;
        }
        
        .category-text {
            vertical-align: middle;
        }
        
        /* ØªØ®ØµÙŠØµ Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±) */
        [dir="rtl"] .category-icon {
            margin-right: 0;
            margin-left: 8px;
        }
        
        /* ØªÙƒØ¨ÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ø¥Ø¨Ø±Ø§Ø²Ù‡Ø§ */
        .filter-btn.active .category-icon {
            font-size: 1.3em;
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª */
        .filter-btn {
            display: flex;
            align-items: center;
            padding: 8px 15px;
        }
        

        
        /* Ø£Ù†Ù…Ø§Ø· Ø¥Ø´Ø¹Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ± */
        #filter-status-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(58, 16, 69, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 14px;
            max-width: 90%;
            width: auto;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(177, 76, 200, 0.3);
        }
        
        .filter-status-content {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-status-icon {
            font-size: 16px;
        }
        
        .filter-status-text {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }
        
        .filter-status-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 0 0 0 10px;
            margin: 0;
        }
    </style>
</head>
<body>
    <!-- Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ - ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· -->
    <div class="site-header">
        <div class="header-left">
            <div class="site-logo-container">
                <img src="Imges/Leonardo_Anime_XL_A_futuristic_and_modern_logo_design_suitable_1 (1).jpg" alt="website logo" class="header-logo-small">
                <h1 class="site-name-small">ArtWall.A</h1>
            </div>
        </div>

        <div class="header-right">
            <div class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <div class="sidebar" id="sidebar">
        <div class="logo-section">
            <img src="Imges/Leonardo_Anime_XL_A_futuristic_and_modern_logo_design_suitable_1 (1).jpg" alt="website logo" class="sidebar-logo">
        </div>
        <div class="account-section">
            <h3 data-i18n="myAccount">Ø­Ø³Ø§Ø¨ÙŠ</h3>
            <div id="user-info" style="display: flex; align-items: center; margin-bottom: 15px; width: 100%; position: relative; cursor: pointer;" onclick="toggleUserMenu()">
                <img id="user-avatar" src="Imges/Boy Cole _ Anime pictures .jpg" alt="User Avatar" class="user-avatar">
                <div style="flex: 1; min-width: 0; display: flex; justify-content: space-between; align-items: center;">
                    <span id="user-name" style="color: white; font-weight: bold; display: block !important; font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; direction: ltr; text-align: left;"></span>
                    <span style="margin-left: 5px; margin-right: 5px;"><i class="fas fa-chevron-down" id="user-dropdown-icon"></i></span>
                </div>
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <div id="user-dropdown-menu" class="user-dropdown-content" style="display: none;">
                    <a href="#" onclick="openSettings(); return false;" style="text-align: left; direction: ltr;">
                        <i class="fas fa-cog"></i> <span data-i18n="settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                    </a>
                    <a href="#" onclick="logout(); return false;" style="text-align: left; direction: ltr;">
                        <i class="fas fa-sign-out-alt"></i> <span data-i18n="logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                    </a>
                    <div class="user-dropdown-email" style="text-align: left; direction: ltr;">
                        <i class="fas fa-envelope"></i> <span id="user-email">user@example.com</span>
                    </div>
                </div>
            </div>
            
            <style>
                /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… */
                .user-dropdown-content {
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    background: linear-gradient(135deg, rgba(25, 5, 30, 0.95), rgba(45, 15, 50, 0.95));
                    border: 1px solid rgba(255, 255, 255, 0.15);
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                    z-index: 100;
                    overflow: hidden;
                    width: 100%;
                    margin-top: 5px;
                }
                
                .user-dropdown-content a {
                    display: block;
                    padding: 12px 15px;
                    color: white;
                    text-decoration: none;
                    transition: background 0.3s;
                    font-size: 14px;
                }
                
                .user-dropdown-content a:hover {
                    background: rgba(255, 255, 255, 0.1);
                }
                
                .user-dropdown-email {
                    padding: 12px 15px;
                    color: rgba(255, 255, 255, 0.7);
                    font-size: 12px;
                    background: rgba(0, 0, 0, 0.2);
                    border-top: 1px solid rgba(255, 255, 255, 0.1);
                    word-break: break-all;
                }
                
                #user-dropdown-icon {
                    font-size: 12px;
                    color: rgba(255, 255, 255, 0.7);
                    transition: transform 0.3s;
                }
                
                #user-info:hover #user-dropdown-icon {
                    color: white;
                }
            </style>
            <button class="auth-btn" onclick="window.location.href='simple-gallery.html'">
                <span style="margin-right: 8px;">ğŸ </span>
                <span data-i18n="home">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </button>
            <button class="auth-btn" onclick="window.location.href='profile.html'">
                <span style="margin-right: 8px;">ğŸ‘¤</span>
                <span data-i18n="myProfile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
            </button>
            <button class="auth-btn" onclick="window.location.href='favorites.html'">
                <span style="margin-right: 8px;">â™¥</span>
                <span data-i18n="myFavorites">Ø§Ù„Ù…ÙØ¶Ù„Ø©</span>
            </button>
            
            <!-- Ù‚Ø³Ù… Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ± -->
            <div class="dimensions-section">
                <h3 class="dimensions-title" data-i18n="imageDimensions">Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±</h3>
                <div class="dimensions-buttons">
                    <button class="dimension-btn dimension-btn-all active" data-dimension="all" onclick="filterByDimension('all')">
                        <img src="Imges/All img icon.png" alt="All" />
                    </button>
                    <button class="dimension-btn dimension-btn3" data-dimension="portrait" onclick="filterByDimension('portrait')">
                        <img src="Imges/length img icon 2;3.jpg" alt="2:3" />
                    </button>
                    <button class="dimension-btn dimension-btn3" data-dimension="square" onclick="filterByDimension('square')">
                        <img src="Imges/square img icon 1;1.jpg" alt="1:1" />
                    </button>
                    <button class="dimension-btn dimension-btn3" data-dimension="landscape" onclick="filterByDimension('landscape')">
                        <img src="Imges/an offer img icon 16;9.jpg" alt="16:9" />
                    </button>
                </div>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ -->
            <div class="dimensions-section">
                <h3 class="dimensions-title" data-i18n="viewMode">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶</h3>
                <div class="dimensions-buttons">
                    <button id="defaultViewBtn" class="view-mode-btn active" onclick="setGridColumnsWithSearch('default')">
                        <i class="fas fa-grip-vertical"></i>
                    </button>
                    <button id="wideViewBtn" class="view-mode-btn" onclick="setGridColumnsWithSearch('wide')" style="position: relative;">
                        <i class="fas fa-grip-horizontal"></i>
                        <i class="fas fa-ban mobile-disabled-icon" style="position: absolute; top: 2px; right: 2px; font-size: 10px; color: #ff6b6b; display: block;"></i>
                    </button>
                </div>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø¯ÙˆØ§Øª -->
            <div class="dimensions-section">
                <h3 class="dimensions-title" data-i18n="tools">Ø£Ø¯ÙˆØ§Øª</h3>
                <div class="sidebar-tools">
                    <div class="language-dropdown">
                        <button id="langToggleBtn" class="lang-switcher-new">
                            <span class="lang-icon">ğŸŒ</span>
                            <span data-i18n="language">Ø§Ù„Ù„ØºØ©</span> <span class="down-arrow">&#9660;</span>
                        </button>
                        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© -->
                        <div id="languageMenu" class="language-dropdown-content">
                            <a href="#" data-lang="ar" class="lang-option active" onclick="switchLanguage('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
                            <a href="#" data-lang="en" class="lang-option" onclick="switchLanguage('en')">English</a>
                            <a href="#" data-lang="fr" class="lang-option lang-disabled" onclick="showLanguageTodo('fr')">FranÃ§ais</a>
                            <a href="#" data-lang="es" class="lang-option lang-disabled" onclick="showLanguageTodo('es')">EspaÃ±ol</a>
                        </div>
                    </div>
                    
                    <!-- Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
                    <button id="settingsBtn" class="settings-btn" onclick="openSettings()">
                        <i class="fas fa-cog"></i>
                        <span data-i18n="settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                    </button>
                    
                    <style>
                        .settings-btn {
                            display: flex;
                            align-items: center;
                            background: rgba(0, 0, 0, 0.2);
                            color: white;
                            border: none;
                            border-radius: 8px;
                            padding: 10px 15px;
                            font-size: 14px;
                            cursor: pointer;
                            margin-top: 10px;
                            transition: all 0.3s ease;
                            width: 100%;
                            justify-content: flex-start;
                            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                            text-align: left;
                        }
                        
                        .settings-btn:hover {
                            background: rgba(80, 20, 95, 0.3);
                        }
                        
                        .settings-btn i {
                            margin-right: 8px;
                            font-size: 16px;
                            color: #b44ccc;
                        }
                        
                        /* ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© */
                        html[dir="rtl"] .settings-btn {
                            text-align: right;
                            justify-content: flex-start;
                        }
                        
                        html[dir="rtl"] .settings-btn i {
                            margin-right: 0;
                            margin-left: 8px;
                        }
                    </style>
                    
                    <!-- Ø³ÙŠØªÙ… Ù†Ù‚Ù„ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ØµØºØ±Ø© Ø¥Ù„Ù‰ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
                        <style>
                            /* ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø®Ù„ÙÙŠØ© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© */
                            #languageMenu a.active {
                                background-color: rgba(177, 76, 200, 0.5);
                                width: 100%;
                                box-sizing: border-box;
                                font-weight: bold;
                            }
                            
                            /* Ø£Ù†Ù…Ø§Ø· Ù„Ù„ØºØ§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© */
                            #languageMenu a.lang-disabled {
                                opacity: 0.7;
                                background: rgba(0, 0, 0, 0.15);
                                cursor: default;
                            }
                            
                            /* Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ù„Ù„ØºØ§Øª Ø§Ù„ÙØ±Ù†Ø³ÙŠØ© ÙˆØ§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠØ© */
                            #languageMenu a[data-lang="fr"]::before {
                                content: 'ğŸ‡«ğŸ‡·';
                            }
                            
                            #languageMenu a[data-lang="es"]::before {
                                content: 'ğŸ‡ªğŸ‡¸';
                            }
                            
                            /* Ø­Ù„ Ø¨Ø³ÙŠØ·: ØªØ«Ø¨ÙŠØª Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø±Ù…Ù„ÙŠØ© ÙÙŠ Ù…ÙƒØ§Ù† Ø«Ø§Ø¨Øª */
                            #languageMenu a.lang-disabled {
                                position: relative;
                            }
                            
                            #languageMenu a.lang-disabled::after {
                                content: 'â³';
                                position: absolute !important;
                                right: 40px !important;
                                top: 50% !important;
                                transform: translateY(-50%) !important;
                                color: rgba(255, 255, 255, 0.85) !important;
                                font-size: 1.1em !important;
                                text-shadow: 0 0 3px rgba(0, 0, 0, 0.5) !important;
                                pointer-events: none;
                            }
                            
                            /* Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„ØºØ§Øª Ù„ÙŠØ¸Ù‡Ø±ÙˆØ§ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ */
                            /* ØªØ£Ø«ÙŠØ± Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© */
                            #languageMenu {
                                /* Ø£Ø³Ù„ÙˆØ¨ Ù…ØªÙ†Ø§Ø³Ù‚ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© ÙƒØ§Ù…Ù„Ø© */
                                position: relative;
                                overflow: visible;
                            }
                            
                            #languageMenu::after {
                                content: '';
                                position: absolute;
                                top: -20px;
                                left: -20px;
                                right: -20px;
                                bottom: -20px;
                                width: auto;  /* ØªØ­Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¹Ø±Ø¶ */
                                height: auto; /* ØªØ­Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø§Ø±ØªÙØ§Ø¹ */
                                background: linear-gradient(
                                  217deg, 
                                  rgba(177, 76, 200, 0.08), 
                                  rgba(177, 76, 200, 0) 70%
                                ),
                                linear-gradient(
                                  127deg, 
                                  rgba(0, 230, 255, 0.09), 
                                  rgba(0, 230, 255, 0) 70%
                                ),
                                linear-gradient(
                                  336deg, 
                                  rgba(176, 38, 255, 0.08), 
                                  rgba(176, 38, 255, 0) 70%
                                );
                                z-index: -2;
                                border-radius: 25px;
                                transform-origin: center;
                                animation: gradientMove 8s ease infinite;
                                /* Ø¶Ù…Ø§Ù† Ø«Ø¨Ø§Øª Ø­Ø¬Ù… Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© Ø¹Ù†Ø¯ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© */
                                transform: translateZ(0);
                                backface-visibility: hidden;
                                perspective: 1000px;
                                padding: 20px; /* Ø¥Ø¶Ø§ÙØ© ØªØ¨Ø§Ø¹Ø¯ Ø¯Ø§Ø®Ù„ÙŠ */
                                box-sizing: border-box; /* Ø¶Ù…Ø§Ù† Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø¶Ù…Ù† Ø§Ù„Ø­Ø¬Ù… */
                            }
                            /* ØªØ£Ø«ÙŠØ± ØªÙˆÙ‡Ø¬ Ø¨Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ø±Ø¶ */
                            #languageMenu::before {
                                content: '';
                                position: absolute;
                                top: -15px;
                                left: -15px;
                                right: -15px;
                                bottom: -15px;
                                background: radial-gradient(circle at center, rgba(177, 76, 200, 0.25), transparent 70%);
                                pointer-events: none;
                                z-index: -1;
                                border-radius: 20px;
                                animation: glowPulse 3s infinite alternate;
                            }
                        </style>
                    </div>
                </div>
            </div>
            
            <!-- Ù…Ø³Ø§Ø­Ø© ÙØ§Ø±ØºØ© Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„ØªÙ…Ø±ÙŠØ± Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù‚Ù„Ø¨ -->
            <div class="sidebar-spacer" style="height: 120px; padding-bottom: 80px;">
                <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ØµØºØ±Ø© - Ù…Ù†Ù‚ÙˆÙ„Ø© Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ù‚Ù„Ø¨ -->
                <div class="mini-stats">
                    <div class="mini-stat-item">
                        <span id="favorites-count">0</span>
                        <span data-i18n="favCount">Ù…ÙØ¶Ù„Ø©</span>
                    </div>
                    <div class="mini-stat-item">
                        <span id="likes-count">0</span>
                        <span data-i18n="likeCount">Ø¥Ø¹Ø¬Ø§Ø¨</span>
                    </div>
                </div>
                
                <div class="heart-icon">
                    <i class="fas fa-heart"></i>
                </div>
            </div>
            <!-- Ø¹Ù†ØµØ± Ø¥Ø¶Ø§ÙÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø­ØªÙ‰ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
            <div style="height: 50px;"></div>
            
            <style>
                .mini-stats {
                    display: flex;
                    justify-content: space-between;
                    width: 100%;
                    font-size: 10px;
                    padding: 0 15px;
                    margin-bottom: 15px;
                    position: absolute;
                    bottom: 60px;
                    left: 0;
                    right: 0;
                }
                
                .mini-stat-item {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 5px;
                    padding: 2px 10px;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                }
                
                .mini-stat-item span:first-child {
                    font-weight: bold;
                    font-size: 12px;
                    color: #b44ccc;
                }
                
                .mini-stat-item span:last-child {
                    font-size: 9px;
                    color: rgba(255, 255, 255, 0.7);
                }
            </style>
        </div>
    </div>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="main-content">
        <div class="gallery-container">
            <!-- Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø²Ø± ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª -->
            <div class="search-container">
                <!-- Ø²Ø± Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - Ù…Ù†Ù‚ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± -->
                <button class="filter-toggle-btn active" id="filterToggleBtn" title="Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª" data-i18n-title="linkSearchFilters">
                    <i class="fas fa-link"></i>
                    <span class="filter-status-text" data-i18n="searchLinked">Ù…Ø±Ø¨ÙˆØ·</span>
                </button>
                
                <input type="text" class="search-input" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… ØµÙˆØ±Ø©..." data-i18n-placeholder="searchPlaceholder">
                <i class="fas fa-search search-icon"></i>
            </div>
            
            <!-- Ø­Ø§ÙˆÙŠØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø«Ø¨ØªØ© -->
            <div class="filters-container">
                <div class="filters">
                    <button class="filter-btn active" data-category="all" data-i18n="allImages"><span class="category-icon"><i class="fas fa-th-large" style="font-size: 0.9em;"></i></span> <span class="category-text">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±</span></button>
                    <button class="filter-btn" data-category="animals" data-i18n="animals"><span class="category-icon">ğŸ¦</span> <span class="category-text">Ø­ÙŠÙˆØ§Ù†Ø§Øª</span></button>
                    <button class="filter-btn" data-category="anime" data-i18n="anime"><span class="category-icon">&#10022;</span> <span class="category-text">Ø£Ù†Ù…ÙŠ</span></button>
                    <button class="filter-btn" data-category="creativity" data-i18n="creativity"><span class="category-icon">ğŸ¨</span> <span class="category-text">Ø¥Ø¨Ø¯Ø§Ø¹</span></button>
                    <button class="filter-btn" data-category="technology" data-i18n="technology"><span class="category-icon">ğŸ’»</span> <span class="category-text">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§</span></button>
                    <button class="filter-btn" data-category="world" data-i18n="world"><span class="category-icon">ğŸŒ</span> <span class="category-text">Ø¹Ø§Ù„Ù…</span></button>
                    <button class="filter-btn" data-category="space" data-i18n="space"><span class="category-icon">ğŸš€</span> <span class="category-text">ÙØ¶Ø§Ø¡</span></button>
                    <button class="filter-btn" data-category="classic" data-i18n="classic"><span class="category-icon">ğŸ›ï¸</span> <span class="category-text">ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</span></button>
                </div>
            </div>
            
            <div class="masonry-grid">
                <div class="grid-sizer"></div>
                <div class="gutter-sizer"></div>
                <!-- ØµÙˆØ± Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø³ØªØ¶Ø§Ù Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
            </div>
        </div>
    </div>
    
    <script>
        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        function initMenuToggle() {
            const menuButton = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const body = document.body;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±
            if (!menuButton || !sidebar) {
                console.error('Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©!');
                return;
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            menuButton.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                sidebar.classList.add('user-toggled');
                
                // ØªØºÙŠÙŠØ± Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                const icon = menuButton.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
                
                // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ localStorage
                localStorage.setItem('sidebarOpen', sidebar.classList.contains('active') ? 'true' : 'false');
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ¶Ø¨Ø· Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            function checkScreenSize() {
                if (window.innerWidth >= 1200) { // Ø´Ø§Ø´Ø§Øª Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                    sidebar.classList.add('active', 'desktop-mode');
                    body.classList.add('sidebar-expanded');
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                    menuButton.style.display = 'none';
                } else { // Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù‡ÙˆØ§ØªÙ ÙˆØ§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ©
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
                    menuButton.style.display = 'flex';
                    
                    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ù† localStorage
                    const isOpen = localStorage.getItem('sidebarOpen') === 'true';
                    
                    // Ø¥Ø²Ø§Ù„Ø© ÙˆØ¶Ø¹ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
                    sidebar.classList.remove('desktop-mode');
                    body.classList.remove('sidebar-expanded');
                    
                    // Ø¶Ø¨Ø· Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    if (isOpen && sidebar.classList.contains('user-toggled')) {
                        sidebar.classList.add('active');
                    } else {
                        sidebar.classList.remove('active');
                    }
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                updateMenuIcon();
            }
            
            // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            function updateMenuIcon() {
                const icon = menuButton.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            }
            
            // ØªÙØ¹ÙŠÙ„ ÙØ­Øµ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…
            window.addEventListener('resize', checkScreenSize);
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            checkScreenSize();
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„ØµÙØ­Ø© Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ (Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©)
            document.addEventListener('click', function(event) {
                if (window.innerWidth < 1200 && 
                    sidebar.classList.contains('active') && 
                    !sidebar.contains(event.target) && 
                    !menuButton.contains(event.target)) {
                    sidebar.classList.remove('active');
                    updateMenuIcon();
                }
            });
        }
        
        // ÙˆØ¸ÙŠÙØ© Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ A
        function initFilterToggle() {
            const filterToggleBtn = document.getElementById('filterToggleBtn');
            const searchInput = document.getElementById('searchInput');
            const filterStatusText = filterToggleBtn.querySelector('.filter-status-text');
            
            if (!filterToggleBtn || !searchInput) {
                console.error('Ø¹Ù†Ø§ØµØ± Ø²Ø± Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©!');
                return;
            }
            
            // Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø¨Ø· (Ù…Ø±Ø¨ÙˆØ· Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ)
            let searchLinked = true;
            
            // Ø­ÙØ¸ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø¨Ø· Ù…Ù† localStorage
            const savedState = localStorage.getItem('searchLinked');
            if (savedState !== null) {
                searchLinked = savedState === 'true';
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            updateLinkState();
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø±
            filterToggleBtn.addEventListener('click', function() {
                searchLinked = !searchLinked;
                updateLinkState();
                
                // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                localStorage.setItem('searchLinked', searchLinked.toString());
                
                console.log('ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ø¥Ù„Ù‰:', searchLinked ? 'Ù…Ø±Ø¨ÙˆØ·' : 'Ù…Ù†ÙØµÙ„');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù†Øµ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø«
                if (searchInput.value.trim()) {
                    const searchEvent = new Event('input');
                    searchInput.dispatchEvent(searchEvent);
                }
            });
            
            // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø¨Ø·
            function updateLinkState() {
                const currentLang = document.documentElement.getAttribute('dir') === 'rtl' ? 'ar' : 'en';
                const searchContainer = document.querySelector('.search-container');
                
                if (searchLinked) {
                    filterToggleBtn.classList.remove('inactive');
                    filterToggleBtn.classList.add('active');
                    searchContainer.classList.remove('unlinked');
                    
                    // Ù†Øµ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                    filterStatusText.textContent = currentLang === 'ar' ? 'Ù…Ø±Ø¨ÙˆØ·' : 'Linked';
                    filterToggleBtn.title = currentLang === 'ar' ? 'ÙØµÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª' : 'Unlink Search from Filters';
                } else {
                    filterToggleBtn.classList.remove('active');
                    filterToggleBtn.classList.add('inactive');
                    searchContainer.classList.add('unlinked');
                    
                    // Ù†Øµ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                    filterStatusText.textContent = currentLang === 'ar' ? 'Ù…Ù†ÙØµÙ„' : 'Separate';
                    filterToggleBtn.title = currentLang === 'ar' ? 'Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª' : 'Link Search with Filters';
                }
            }
            
            // Ø¥Ø±Ø¬Ø§Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø¨Ø· Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ ÙˆØ¸Ø§Ø¦Ù Ø£Ø®Ø±Ù‰
            window.isSearchLinked = function() {
                return searchLinked;
            };
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
        function filterByDimension(dimension) {
            console.log('ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯:', dimension);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª
            const isLinked = window.isSearchLinked ? window.isSearchLinked() : true;
            const hasSearchTerm = window.searchFilter && window.searchFilter.trim();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø¹Ø¯ ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„Ø¹Ø§Ù…
            window.currentDimensionFilter = dimension;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.dimension-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const targetBtn = document.querySelector(`.dimension-btn[data-dimension="${dimension}"]`);
            if (targetBtn) targetBtn.classList.add('active');
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª ÙˆÙŠÙˆØ¬Ø¯ Ù†Øµ Ø¨Ø­Ø«
            if (!isLinked && hasSearchTerm) {
                console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø­ØªÙ‰ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ÙØµÙ„Ø©)
                searchGallery(window.searchFilter);
                return;
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª ÙˆÙŠÙˆØ¬Ø¯ Ù†Øµ Ø¨Ø­Ø«
            if (isLinked && hasSearchTerm) {
                console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯');
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                searchGallery(window.searchFilter);
                return;
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¨Ø­Ø« Ù†Ø´Ø·ØŒ Ø·Ø¨Ù‚ ÙÙ„ØªØ± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙ‚Ø·
            applyFilters();
            refreshMasonry();
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ù‚ØµÙŠØ±Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
            setTimeout(() => {
                applyFilters();
                refreshMasonry();
            }, 100);
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙ‚Ø· (Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ÙØµÙ„Ø©)
        function applyDimensionFilterOnly(dimension) {
            if (!window.hiddenItems) {
                window.hiddenItems = new Set();
            }
            
            const gridItems = document.querySelectorAll('.grid-item');
            
            gridItems.forEach(item => {
                const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                
                if (!item.getAttribute('data-id')) {
                    item.setAttribute('data-id', itemId);
                }
                
                let show = true;
                
                // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙ‚Ø·
                if (dimension !== 'all') {
                    const itemDimension = item.getAttribute('data-dimension');
                    
                    if (itemDimension && itemDimension !== dimension) {
                        show = false;
                    } else if (!itemDimension) {
                        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ø¹Ø¯ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø­Ø¯Ø¯
                        const image = item.querySelector('img.gallery-image');
                        if (image && image.complete && image.naturalWidth > 0) {
                            const calculatedDimension = getImageDimensionType(image);
                            item.setAttribute('data-dimension', calculatedDimension);
                            
                            if (calculatedDimension !== dimension) {
                                show = false;
                            }
                        }
                    }
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±
                if (!show) {
                    window.hiddenItems.add(itemId);
                } else {
                    window.hiddenItems.delete(itemId);
                }
                
                applyItemVisibility(item, show);
            });
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
        function filterByCategory(category) {
            console.log('ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©:', category);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª
            const isLinked = window.isSearchLinked ? window.isSearchLinked() : true;
            const hasSearchTerm = window.searchFilter && window.searchFilter.trim();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙØ¦Ø© ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„Ø¹Ø§Ù…
            window.currentCategoryFilter = category;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const targetBtn = document.querySelector(`.filter-btn[data-category="${category}"]`);
            if (targetBtn) targetBtn.classList.add('active');
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª ÙˆÙŠÙˆØ¬Ø¯ Ù†Øµ Ø¨Ø­Ø«
            if (!isLinked && hasSearchTerm) {
                console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø«');
                
                // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†Ø´Ø·
                applyCategoryWithActiveSearch(category);
                refreshMasonry();
                return;
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª ÙˆÙŠÙˆØ¬Ø¯ Ù†Øµ Ø¨Ø­Ø«
            if (isLinked && hasSearchTerm) {
                console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©');
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                searchGallery(window.searchFilter);
                return;
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¨Ø­Ø« Ù†Ø´Ø·ØŒ Ø·Ø¨Ù‚ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø© ÙÙ‚Ø·
            applyFilters();
            refreshMasonry();
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ù‚ØµÙŠØ±Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
            setTimeout(() => {
                applyFilters();
                refreshMasonry();
            }, 100);
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø« Ù†Ø´Ø·Ø§Ù‹ (Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ÙØµÙ„Ø©)
        function applyCategoryWithActiveSearch(category) {
            if (!window.hiddenItems) {
                window.hiddenItems = new Set();
            }
            
            const gridItems = document.querySelectorAll('.grid-item');
            const hasSearchTerm = window.searchFilter && window.searchFilter.trim();
            
            gridItems.forEach(item => {
                const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                
                if (!item.getAttribute('data-id')) {
                    item.setAttribute('data-id', itemId);
                }
                
                let show = true;
                
                // Ø£ÙˆÙ„Ø§Ù‹: ÙØ­Øµ Ø§Ù„Ø¨Ø­Ø« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†Ø´Ø·Ø§Ù‹ (Ù„Ù‡ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†ÙØµÙ„Ø©)
                if (hasSearchTerm) {
                    const title = item.getAttribute('data-title')?.toLowerCase() || '';
                    const itemCategory = item.getAttribute('data-category')?.toLowerCase() || '';
                    const tags = item.getAttribute('data-tags')?.toLowerCase() || '';
                    
                    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø©
                    const titleElement = item.querySelector('.image-title-badge');
                    const titleText = titleElement ? titleElement.textContent.toLowerCase() : '';
                    
                    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙØ¦Ø© Ø§Ù„ØµÙˆØ±Ø©
                    const categoryElement = item.querySelector('.category-badge');
                    const categoryText = categoryElement ? categoryElement.textContent.toLowerCase() : '';
                    
                    // Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù†ØµÙˆØµ Ù„Ù„Ø¨Ø­Ø« ÙÙŠÙ‡Ø§
                    const searchableText = `${title} ${itemCategory} ${tags} ${titleText} ${categoryText}`;
                    
                    const match = searchableText.includes(window.searchFilter.toLowerCase().trim());
                    if (!match) {
                        show = false;
                    }
                }
                
                // Ø«Ø§Ù†ÙŠØ§Ù‹: ÙØ­Øµ Ù…Ø±Ø´Ø­ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (ÙŠØ¨Ù‚Ù‰ Ù†Ø´Ø·Ø§Ù‹ Ø¯Ø§Ø¦Ù…Ø§Ù‹)
                if (window.currentDimensionFilter && window.currentDimensionFilter !== 'all' && show) {
                    const itemDimension = item.getAttribute('data-dimension') || '';
                    if (itemDimension && itemDimension !== window.currentDimensionFilter) {
                        show = false;
                    }
                }
                
                // Ø«Ø§Ù„Ø«Ø§Ù‹: ÙØ­Øµ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø© (ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¨Ø­Ø« Ù†Ø´Ø·)
                if (!hasSearchTerm && category !== 'all' && show) {
                    const itemCategory = item.getAttribute('data-category');
                    if (itemCategory !== category) {
                        show = false;
                    }
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±
                if (!show) {
                    window.hiddenItems.add(itemId);
                } else {
                    window.hiddenItems.delete(itemId);
                }
                
                applyItemVisibility(item, show);
            });
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØ·Ø¨ÙŠÙ‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±
        function applyFilters() {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ© Ù„Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
            const category = window.currentCategoryFilter || 'all';
            const dimension = window.currentDimensionFilter || 'all';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù„ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ø±ÙØ§Øª Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (!window.hiddenItems) {
                window.hiddenItems = new Set();
            }
            
            // ØªØ¬Ù†Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØµÙÙŠØ© ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            
            const gridItems = document.querySelectorAll('.grid-item');
            
            gridItems.forEach(item => {
                const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                if (!item.getAttribute('data-id')) {
                    item.setAttribute('data-id', itemId);
                }
                
                let show = true;
                
                // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø©
                if (category !== 'all') {
                    const itemCategory = item.getAttribute('data-category');
                    if (itemCategory !== category) {
                        show = false;
                    }
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
                if (dimension !== 'all' && show) {
                    // Ø£ÙˆÙ„Ø§ØŒ Ù†Ø­Ø§ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ù…Ø© data-dimension Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù…Ø³Ø¨Ù‚Ø§ ÙˆØ§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø¯Ø§Ù„Ø© getImageDimensionType
                    const itemDimension = item.getAttribute('data-dimension');
                    
                    if (itemDimension && itemDimension !== dimension) {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ù„Ø¹Ù†ØµØ± Ø®Ø§ØµÙŠØ© dimension ÙˆÙ„Ø§ ØªØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙÙ„ØªØ±
                        show = false;
                    } else if (!itemDimension) {
                        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø³Ù…Ø© dimension Ø¨Ø¹Ø¯ØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø­Ø³Ø§Ø¨Ù‡Ø§ ÙˆØªØ®Ø²ÙŠÙ†Ù‡Ø§
                        const image = item.querySelector('img.gallery-image');
                        if (image && image.complete && image.naturalWidth > 0) {
                            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ø¹Ø¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©
                            const calculatedDimension = getImageDimensionType(image);
                            
                            // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨ ÙÙŠ Ø§Ù„Ø³Ù…Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
                            item.setAttribute('data-dimension', calculatedDimension);
                            
                            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙÙ„ØªØ±
                            if (calculatedDimension !== dimension) {
                                show = false;
                            }
                        } else {
                            // ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯ØŒ Ù†Ø¹ØªØ¨Ø±Ù‡Ø§ ØªØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙÙ„ØªØ± Ù…Ø¤Ù‚ØªØ§Ù‹
                            console.log('ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯ØŒ Ø³Ù†Ø¹ØªØ¨Ø±Ù‡Ø§ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙÙ„ØªØ±:', dimension);
                            
                            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
                            if (image) {
                                image.onload = function() {
                                    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ø¹Ø¯ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
                                    const loadedDimension = getImageDimensionType(this);
                                    item.setAttribute('data-dimension', loadedDimension);
                                    
                                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙÙ„ØªØ± Ù„Ø§ ÙŠØ²Ø§Ù„ Ù†Ø´Ø·Ø§Ù‹
                                    if (window.currentDimensionFilter === dimension) {
                                        applyFilters();
                                    }
                                };
                            }
                        }
                    }
                }
                
                // ØªØ®Ø²ÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±
                if (!show) {
                    window.hiddenItems.add(itemId);
                } else {
                    window.hiddenItems.delete(itemId);
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶
                applyItemVisibility(item, show);
            });
            
            // ØªØ®Ø²ÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ± ÙÙŠ localStorage
            try {
                localStorage.setItem('currentCategoryFilter', category);
                localStorage.setItem('currentDimensionFilter', dimension);
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±:', e);
            }
        }
        
        // ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¶Ø¨Ø· Ø±Ø¤ÙŠØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙÙ„ØªØ± Ø§Ù„Ø¹Ø±Ø¶
        function applyItemVisibility(item, show) {
            if (show) {
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†ØµØ± - Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
                // Ù†Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø°ÙŠ ÙŠØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ø²Ø± Ø§Ù„Ø£ÙˆÙ„
                item.style.display = '';
                item.style.visibility = 'visible';
                item.style.height = '';
                item.style.margin = '';
                item.style.padding = '';
                item.style.overflow = '';
            } else {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†ØµØ± - Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
                // Ù†Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø°ÙŠ ÙŠØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ø²Ø± Ø§Ù„Ø£ÙˆÙ„
                item.style.display = 'none';
                item.style.visibility = 'hidden';
            }
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Masonry Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±

        
        /**
         * ØªØ­Ø¯ÙŠØ¯ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØªØ§ Ø§Ù„Ù…ØªÙˆÙØ±Ø©
         * @param {Object} imageData - Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙˆØ±Ø©
         * @returns {Object} Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø© (Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø§Ø±ØªÙØ§Ø¹) Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©
         */
        function getPresetDimensions(imageData) {
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            let width = 300; // Ø¹Ø±Ø¶ Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù…Ø¹Ù‚ÙˆÙ„
            let height = 300; // Ø§Ø±ØªÙØ§Ø¹ Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù…Ø¹Ù‚ÙˆÙ„
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¹Ø±ÙˆÙØ§Ù‹)
            if (imageData.dimension === 'portrait' || imageData.orientation === 'portrait') {
                // ØµÙˆØ±Ø© Ø·ÙˆÙ„ÙŠØ©: Ø£Ø·ÙˆÙ„ Ù…Ù† Ø¹Ø±Ø¶Ù‡Ø§
                width = 300;
                height = 450; // Ù†Ø³Ø¨Ø© 2:3 ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
            } else if (imageData.dimension === 'landscape' || imageData.orientation === 'landscape') {
                // ØµÙˆØ±Ø© Ø¹Ø±Ø¶ÙŠØ©: Ø£Ø¹Ø±Ø¶ Ù…Ù† Ø·ÙˆÙ„Ù‡Ø§
                width = 450;
                height = 300; // Ù†Ø³Ø¨Ø© 3:2 ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
            } else if (imageData.dimension === 'square' || imageData.orientation === 'square') {
                // ØµÙˆØ±Ø© Ù…Ø±Ø¨Ø¹Ø©
                width = 300;
                height = 300;
            }
            
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù†Ø·Ù‚ Ù‡Ù†Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø¨Ø¹Ø§Ø¯ Ø£ÙƒØ«Ø± Ø¯Ù‚Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©
            
            return { width, height };
        }

        function refreshMasonry() {
            const grid = document.querySelector('.masonry-grid');
            if (!grid) return;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª
            const screenWidth = window.innerWidth;
            const isMobile = screenWidth <= 480;
            const isWideView = document.body.classList.contains('wide-view');
            const isWideMobileView = document.body.classList.contains('wide-mobile-view');
            const needsCustomLayout = isMobile && (isWideView || isWideMobileView);
            
            // Ø¥Ù„ØºØ§Ø¡ Ø£ÙŠ Ù…Ø«ÙŠÙ„Ø§Øª Ø³Ø§Ø¨Ù‚Ø© Ù„Ù€ Masonry Ù‚Ø¨Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            const masonry = Masonry.data(grid);
            if (masonry) {
                masonry.destroy();
                // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø±Ø¬Ø¹ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ
                window.msnry = null;
            }
            
            // ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ Ø£Ù†Ù…Ø§Ø· CSS Ù…ÙˆØ±ÙˆØ«Ø©
            grid.style.height = '';
            
            if (needsCustomLayout) {
                // ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ù…Ø®ØµØµ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
                // Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©: ØµÙˆØ±ØªØ§Ù† ÙÙŠ ØµÙ ÙˆØ§Ø­Ø¯ (Ø¨Ø¯ÙˆÙ† Ø£Ø¹Ù…Ø¯Ø© Ù…ØªØ¹Ø¯Ø¯Ø©)
                
                // ØªØ·Ø¨ÙŠÙ‚ Ù†Ù…Ø· columns Ù„Ù„Ø­Ø§ÙˆÙŠØ©
                grid.style.display = 'block';
                grid.style.columnCount = '2';
                grid.style.columnGap = '6px';
                
                // Ø¶Ø¨Ø· Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠÙ†
                const items = document.querySelectorAll('.grid-item');
                items.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                    item.style.width = '100%';
                    item.style.marginBottom = '6px';
                    item.style.breakInside = 'avoid';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ø¨Ø§Ù„Ø¶Ø¨Ø· ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    if (isHidden) {
                        // Ù†Ø³ØªØ®Ø¯Ù… display:none ØªÙ…Ø§Ù…Ù‹Ø§ Ù…Ø«Ù„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†ØµØ±
                        item.style.display = 'inline-block';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.margin = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                // Ø¥Ø®ÙØ§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„ØªØ­Ø¬ÙŠÙ…
                const sizer = document.querySelector('.grid-sizer');
                if (sizer) sizer.style.display = 'none';
                
                return; // Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„ØªÙ‡ÙŠØ¦Ø© Masonry
            } else {
                // Ø§Ø³ØªØ®Ø¯Ù… Masonry Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£ÙƒØ¨Ø± Ø£Ùˆ Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±ÙŠØ¶
                setTimeout(() => {
                    new Masonry(grid, {
                        itemSelector: '.grid-item',
                        columnWidth: '.grid-sizer',
                        gutter: '.gutter-sizer',
                        percentPosition: true
                    });
                }, 200);
            }
        }
        
        /**
         * Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
         * ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø© ÙˆÙŠØ¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
         */
        function handleWideViewClick() {
            const screenWidth = window.innerWidth;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© (768px Ø£Ùˆ Ø£Ù‚Ù„)
            if (screenWidth <= 768) {
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
                showCustomAlert();
                return;
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø´Ø§Ø´Ø© ØµØºÙŠØ±Ø©ØŒ ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
            setGridColumns('wide');
        }

        /**
         * Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ Ù…Ø®ØµØµØ© Ø¨ØªØµÙ…ÙŠÙ… Ø¬Ù…ÙŠÙ„
         */
        function showCustomAlert() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const currentLang = localStorage.getItem('language') || 'ar';
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
            const texts = currentLang === 'en' ? {
                title: 'Wide View Not Available',
                message: 'Wide view mode is not available on small screens. Please switch to a larger screen to use this feature.',
                button: 'Got it'
            } : {
                title: 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ ØºÙŠØ± Ù…ØªØ§Ø­',
                message: 'ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±ÙŠØ¶ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø£ÙƒØ¨Ø± Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø©.',
                button: 'ÙÙ‡Ù…Øª'
            };
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const alertOverlay = document.createElement('div');
            alertOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                backdrop-filter: blur(5px);
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const alertBox = document.createElement('div');
            alertBox.style.cssText = `
                background: linear-gradient(135deg, rgba(13, 0, 13, 0.95), rgba(25, 10, 25, 0.95));
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 20px;
                padding: 30px;
                max-width: 350px;
                margin: 20px;
                text-align: center;
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
                transform: scale(0.8);
                animation: popIn 0.3s ease-out forwards;
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
            const style = document.createElement('style');
            style.textContent = `
                @keyframes popIn {
                    to {
                        transform: scale(1);
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
            const icon = document.createElement('div');
            icon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
            icon.style.cssText = `
                font-size: 48px;
                color: #ff6b6b;
                margin-bottom: 20px;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            const title = document.createElement('h3');
            title.textContent = texts.title;
            title.style.cssText = `
                color: white;
                margin: 0 0 15px 0;
                font-size: 20px;
                font-weight: bold;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const message = document.createElement('p');
            message.textContent = texts.message;
            message.style.cssText = `
                color: rgba(255, 255, 255, 0.9);
                margin: 0 0 25px 0;
                line-height: 1.6;
                font-size: 16px;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø²Ø±
            const button = document.createElement('button');
            button.textContent = texts.button;
            button.style.cssText = `
                background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            `;
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ±
            button.addEventListener('mouseenter', () => {
                button.style.transform = 'translateY(-2px)';
                button.style.boxShadow = '0 6px 20px rgba(255, 107, 107, 0.4)';
            });
            
            button.addEventListener('mouseleave', () => {
                button.style.transform = 'translateY(0)';
                button.style.boxShadow = '0 4px 15px rgba(255, 107, 107, 0.3)';
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
            button.addEventListener('click', () => {
                alertOverlay.style.animation = 'fadeOut 0.3s ease-in forwards';
                setTimeout(() => {
                    document.body.removeChild(alertOverlay);
                }, 300);
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
            style.textContent += `
                @keyframes fadeOut {
                    to {
                        opacity: 0;
                        transform: scale(0.9);
                    }
                }
            `;
            
            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
            alertBox.appendChild(icon);
            alertBox.appendChild(title);
            alertBox.appendChild(message);
            alertBox.appendChild(button);
            alertOverlay.appendChild(alertBox);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„ØµÙØ­Ø©
            document.body.appendChild(alertOverlay);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø±Ø¨Ø¹
            alertOverlay.addEventListener('click', (e) => {
                if (e.target === alertOverlay) {
                    button.click();
                }
            });
        }

        /**
         * ØªØºÙŠÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶
         * ÙˆØ¸ÙŠÙØ© Ù…Ø¨Ø³Ø·Ø© ÙˆÙˆØ§Ø¶Ø­Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±
         * @param {string} mode - ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ ('default' Ø£Ùˆ 'wide')
         */
        function setGridColumns(mode) {
            // ØªØºÙŠÙŠØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶
            
            // Ø­ÙØ¸ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            localStorage.setItem('viewMode', mode);
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
            document.getElementById('defaultViewBtn').classList.toggle('active', mode === 'default');
            document.getElementById('wideViewBtn').classList.toggle('active', mode === 'wide');
            
            // ØªØ·Ø¨ÙŠÙ‚ ÙØ¦Ø§Øª CSS Ù„Ù„Ø¬Ø³Ù…
            document.body.classList.toggle('wide-view', mode === 'wide');
            document.body.classList.toggle('default-view', mode === 'default');
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ø±Ø¶
            const gridItems = document.querySelectorAll('.grid-item');
            const gridSizer = document.querySelector('.grid-sizer');
            const masonryGrid = document.querySelector('.masonry-grid');
            
            // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const currentCategory = window.currentCategoryFilter;
            const currentDimension = window.currentDimensionFilter;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            const screenWidth = window.innerWidth;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            if (screenWidth <= 480) {
                // Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© Ø§Ù„ØµØºÙŠØ±Ø©)
                applyMobileLayout(mode, gridItems, gridSizer, masonryGrid);
            } else if (screenWidth > 480 && screenWidth <= 768) {
                // Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© (Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©)
                applyMobileLayout(mode, gridItems, gridSizer, masonryGrid);
            } else if (screenWidth > 768 && screenWidth <= 1199) {
                // Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© (Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ©)
                applyTabletLayout(mode, gridItems, gridSizer, masonryGrid);
            } else {
                // Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± - 1200px ÙÙ…Ø§ ÙÙˆÙ‚)
                applyDesktopLayout(mode, gridItems, gridSizer, masonryGrid);
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (currentCategory) {
                window.currentCategoryFilter = currentCategory;
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                const categoryBtn = document.querySelector(`.filter-btn[data-category="${currentCategory}"]`);
                if (categoryBtn) {
                    categoryBtn.classList.add('active');
                }
            }
            
            if (currentDimension) {
                window.currentDimensionFilter = currentDimension;
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
                document.querySelectorAll('.dimension-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                const dimensionBtn = document.querySelector(`.dimension-btn[data-dimension="${currentDimension}"]`);
                if (dimensionBtn) {
                    dimensionBtn.classList.add('active');
                }
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù†Ø´Ø·Ø©
            applyFilters();
            
            // Ø«Ù… ØªØ·Ø¨ÙŠÙ‚ Masonry Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ØªØ®Ø·ÙŠØ·
            refreshMasonry();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø·ÙŠØ· Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            setTimeout(() => {
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµØ­ÙŠØ­
                applyFilters();
                refreshMasonry();
            }, 200);
        }
        
        /**
         * ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±)
         * @param {string} mode - ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
         * @param {NodeList} gridItems - Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} gridSizer - Ø¹Ù†ØµØ± ØªØ­Ø¬ÙŠÙ… Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} masonryGrid - Ø¹Ù†ØµØ± Ø´Ø¨ÙƒØ© Ù…Ø§Ø³ÙˆÙ†Ø±ÙŠ
         */
        function applyDesktopLayout(mode, gridItems, gridSizer, masonryGrid) {
            if (mode === 'default') {
                // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: 3 ØµÙˆØ± ÙÙŠ ÙƒÙ„ ØµÙ
                document.documentElement.style.setProperty('--grid-columns', '3');
                
                if (gridSizer) gridSizer.style.width = 'calc(33.333% - 10px)';
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    item.style.width = 'calc(33.333% - 10px)';
                    item.style.float = '';
                    item.style.marginRight = '';
                    item.style.breakInside = '';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = '';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.margin = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                resetGridLayout(masonryGrid);
                
            } else if (mode === 'wide') {
                // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶: 4 ØµÙˆØ± ÙÙŠ ÙƒÙ„ ØµÙ
                document.documentElement.style.setProperty('--grid-columns', '4');
                
                if (gridSizer) gridSizer.style.width = 'calc(25% - 11.25px)';
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    item.style.width = 'calc(25% - 11.25px)';
                    item.style.float = '';
                    item.style.marginRight = '';
                    item.style.breakInside = '';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = '';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.margin = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                resetGridLayout(masonryGrid);
            }
        }
        
        /**
         * ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© (Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ©)
         * @param {string} mode - ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
         * @param {NodeList} gridItems - Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} gridSizer - Ø¹Ù†ØµØ± ØªØ­Ø¬ÙŠÙ… Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} masonryGrid - Ø¹Ù†ØµØ± Ø´Ø¨ÙƒØ© Ù…Ø§Ø³ÙˆÙ†Ø±ÙŠ
         */
        function applyTabletLayout(mode, gridItems, gridSizer, masonryGrid) {
            if (mode === 'default') {
                // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: 2 ØµÙˆØ± ÙÙŠ ÙƒÙ„ ØµÙ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Masonry
                document.documentElement.style.setProperty('--medium-columns', '2');
                
                if (gridSizer) gridSizer.style.width = 'calc(50% - 10px)';
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    // Ø¶Ø¨Ø· Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Masonry
                    item.style.width = 'calc(50% - 10px)';
                    item.style.float = '';  // Ø¥Ø²Ø§Ù„Ø© float Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Masonry
                    item.style.marginRight = '';
                    item.style.marginBottom = '15px';
                    item.style.breakInside = '';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = 'block';  // Ø§Ø³ØªØ®Ø¯Ø§Ù… 'block' Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† '' Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØµØ­ÙŠØ­
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                // Ù‡Ù†Ø§ Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø²Ø§Ù„Ø© Masonry Ø«Ù… ØªÙ‡ÙŠØ¦Ø© layout Ø¬Ø¯ÙŠØ¯
                if (masonryGrid) {
                    masonryGrid.style.position = 'relative';
                    masonryGrid.style.height = 'auto';
                }
                
            } else if (mode === 'wide') {
                // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶: 3 ØµÙˆØ± ÙÙŠ ÙƒÙ„ ØµÙ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Masonry
                document.documentElement.style.setProperty('--medium-columns', '3');
                
                if (gridSizer) gridSizer.style.width = 'calc(33.33% - 10px)';
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    // Ø¶Ø¨Ø· Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Masonry
                    item.style.width = 'calc(33.33% - 10px)';
                    item.style.float = '';  // Ø¥Ø²Ø§Ù„Ø© float Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Masonry
                    item.style.marginRight = '';
                    item.style.marginBottom = '15px';
                    item.style.breakInside = '';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = '';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.margin = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                resetGridLayout(masonryGrid);
            }
        }
        
        /**
         * ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© (Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©)
         * @param {string} mode - ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
         * @param {NodeList} gridItems - Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} gridSizer - Ø¹Ù†ØµØ± ØªØ­Ø¬ÙŠÙ… Ø§Ù„Ø´Ø¨ÙƒØ©
         * @param {Element} masonryGrid - Ø¹Ù†ØµØ± Ø´Ø¨ÙƒØ© Ù…Ø§Ø³ÙˆÙ†Ø±ÙŠ
         */
        function applyMobileLayout(mode, gridItems, gridSizer, masonryGrid) {
            if (mode === 'default') {
                // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ ÙƒÙ„ ØµÙ
                document.documentElement.style.setProperty('--small-columns', '1');
                
                // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø£Ù†Ù…Ø§Ø· Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø§Ø¨Ù‚
                document.body.classList.remove('wide-mobile-view');
                document.body.classList.add('default-mobile-view');
                
                // Ø¥Ø®ÙØ§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¸Ø§Ù‡Ø±Ø§Ù‹
                hideFilterStatusNotification();
                
                // ØªØ¹ÙŠÙŠÙ† Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                if (gridSizer) gridSizer.style.width = '100%';
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¶
                    item.style.width = '100%';
                    item.style.float = 'none';
                    item.style.marginRight = '0';
                    item.style.marginBottom = '15px';
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø´Ø§Ø±Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                    const dimensionBadge = item.querySelector('.dimension-badge');
                    if (dimensionBadge) {
                        dimensionBadge.remove();
                    }
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = 'block';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.margin = '15px 0';
                        item.style.overflow = '';
                    }
                });
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø®ØµØ§Ø¦Øµ Ø´Ø¨ÙƒØ© Masonry
                if (masonryGrid) {
                    masonryGrid.style.display = 'block';
                    masonryGrid.style.columnCount = '1';
                    masonryGrid.style.columnGap = '0';
                    masonryGrid.classList.remove('wide-grid');
                }
                
                // Ø­ÙØ¸ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ù…ØªØºÙŠØ± Ø¹Ø§Ù…
                window.currentViewMode = 'default';
                
            } else if (mode === 'wide') {
                // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ A: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ ÙƒÙˆØ¯ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± ÙÙ‚Ø·
                document.documentElement.style.setProperty('--small-columns', '2');
                
                // Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ø®Ø§ØµØ© Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
                document.body.classList.remove('default-mobile-view');
                document.body.classList.add('wide-mobile-view');
                
                // ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ù…Ø®ØµØµ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
                
                // ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¸Ø§Ù… Masonry Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠÙ†)
                if (masonryGrid) {
                    masonryGrid.style.display = '';
                    masonryGrid.style.columnCount = '';
                    masonryGrid.style.columnGap = '';
                    masonryGrid.style.width = '100%';
                    masonryGrid.classList.add('wide-grid');
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø³Ø§ÙØ© Ø¨Ø§Ø¯Ø¦Ø© Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©ØŒ Ù†Ø¶Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶
                    const sidebarOpen = document.body.classList.contains('sidebar-open');
                    if (sidebarOpen) {
                        masonryGrid.style.marginLeft = '0';
                    }
                }
                
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙˆÙ„ÙƒÙ† Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¬Ù…
                if (gridSizer) gridSizer.style.width = 'calc(50% - 5px)';
                
                gridItems.forEach(item => {
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                    const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                    if (!item.getAttribute('data-id')) {
                        item.setAttribute('data-id', itemId);
                    }
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
                    const isHidden = window.hiddenItems && window.hiddenItems.has(itemId);
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ø³ØªÙ†Ø§Ø¯Ù‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù…Ø¹ Ø¶Ø¨Ø· Ø§Ù„Ø­Ø¬Ù… ÙˆØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ©
                    item.style.width = 'calc(50% - 5px)';
                    item.style.float = 'left';
                    item.style.marginRight = '10px';
                    item.style.marginBottom = '10px';
                    item.style.breakInside = '';
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±/Ø§Ù„Ø¥Ø®ÙØ§Ø¡
                    if (isHidden) {
                        item.style.display = 'none';
                        item.style.visibility = 'hidden';
                    } else {
                        item.style.display = 'block';
                        item.style.visibility = 'visible';
                        item.style.height = '';
                        item.style.padding = '';
                        item.style.overflow = '';
                    }
                });
                
                // Ø¥Ø¶Ø§ÙØ© Masonry Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
                if (!window.msnry && masonryGrid) {
                    setTimeout(() => {
                        window.msnry = new Masonry(masonryGrid, {
                            itemSelector: '.grid-item',
                            columnWidth: '.grid-sizer',
                            percentPosition: true,
                            transitionDuration: '0.3s'
                        });
                    }, 100);
                } else if (window.msnry) {
                    window.msnry.layout();
                }
                
                // Ø­ÙØ¸ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ù…ØªØºÙŠØ± Ø¹Ø§Ù…
                window.currentViewMode = 'wide';
                
                // ØªØ£Ø®ÙŠØ± Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
                setTimeout(() => {
                    refreshMasonry();
                }, 250);
            }
        }

        /**
         * ÙˆØ¸ÙŠÙØ© ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø«
         * @param {string} type - Ù†ÙˆØ¹ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ ('default' Ø£Ùˆ 'wide')
         */
        function setGridColumnsWithSearch(type) {
            console.log('ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø¥Ù„Ù‰:', type);
            
            // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØºÙŠÙŠØ±
            const currentSearch = window.searchFilter;
            const currentCategory = window.currentCategoryFilter;
            const currentDimension = window.currentDimensionFilter;
            const hasSearchTerm = currentSearch && currentSearch.trim();
            const isLinked = window.isSearchLinked ? window.isSearchLinked() : true;
            
            console.log('Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:', {
                search: currentSearch,
                category: currentCategory,
                dimension: currentDimension,
                hasSearch: hasSearchTerm,
                isLinked: isLinked
            });
            
            // ØªØ·Ø¨ÙŠÙ‚ ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
            if (type === 'wide') {
                // Ù„Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±ÙŠØ¶ØŒ Ø§Ø³ØªØ®Ø¯Ù… handleWideViewClick Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ ÙˆØ¥Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ù… setGridColumns
                if (typeof handleWideViewClick === 'function') {
                    handleWideViewClick();
                } else {
                    setGridColumns('wide');
                }
            } else {
                setGridColumns('default');
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ù…Ø±Ø´Ø­Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (hasSearchTerm) {
                console.log('Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶:', currentSearch);
                
                setTimeout(() => {
                    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ù…Ø±Ø´Ø­Ø§Øª
                    window.searchFilter = currentSearch;
                    window.currentCategoryFilter = currentCategory;
                    window.currentDimensionFilter = currentDimension;
                    
                    // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø«
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput) {
                        searchInput.value = currentSearch;
                    }
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø²Ø± Ø§Ù„Ø±Ø¨Ø·
                    if (isLinked) {
                        // Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª
                        console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø¨ÙˆØ· - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª');
                        searchGallery(currentSearch);
                    } else {
                        // Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø¨Ù…ÙØ±Ø¯Ù‡
                        console.log('Ø§Ù„Ø¨Ø­Ø« Ù…Ù†ÙØµÙ„ - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø« Ø¨Ù…ÙØ±Ø¯Ù‡');
                        searchGallery(currentSearch);
                    }
                    
                    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                    updateButtonStates();
                }, 200); // ØªØ£Ø®ÙŠØ± Ø£Ø·ÙˆÙ„ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
            } else {
                console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø­Ø« Ù†Ø´Ø· - Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¹Ø±Ø¶');
            }
        }
        
        /**
         * ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª
         */
        function updateButtonStates() {
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeCategoryBtn = document.querySelector(`.filter-btn[data-category="${window.currentCategoryFilter}"]`);
            if (activeCategoryBtn) activeCategoryBtn.classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
            document.querySelectorAll('.dimension-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeDimensionBtn = document.querySelector(`.dimension-btn[data-dimension="${window.currentDimensionFilter}"]`);
            if (activeDimensionBtn) activeDimensionBtn.classList.add('active');
        }
        

        
        /**
         * Ø§ÙƒØªØ´Ø§Ù Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø¬Ù…Ù‡Ø§
         * @param {HTMLElement} element - Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø©
         * @returns {string} Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¹Ø¯ ('portrait', 'landscape', 'square')
         */
        function detectImageDimension(element) {
            const img = element.querySelector('img');
            if (!img) return 'square';
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯
            if (!img.complete) {
                img.onload = function() {
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
                    const dimension = getImageDimensionType(img);
                    element.setAttribute('data-dimension', dimension);
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                    const badge = element.querySelector('.dimension-badge');
                    if (badge) {
                        updateDimensionBadge(badge, element);
                    }
                };
                return element.getAttribute('data-dimension') || 'square';
            }
            
            return getImageDimensionType(img);
        }
        
        /**
         * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø© (Ø·ÙˆÙ„ÙŠØŒ Ø¹Ø±Ø¶ÙŠØŒ Ù…Ø±Ø¨Ø¹)
         * @param {HTMLImageElement} img - Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø©
         * @returns {string} Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¹Ø¯ ('portrait', 'landscape', 'square')
         */
        function getImageDimensionType(img) {
            const width = img.naturalWidth || img.width || 0;
            const height = img.naturalHeight || img.height || 0;
            
            if (width && height) {
                const ratio = width / height;
                
                if (ratio < 0.9) {
                    return 'portrait';  // Ø·ÙˆÙ„ÙŠ
                } else if (ratio > 1.1) {
                    return 'landscape'; // Ø¹Ø±Ø¶ÙŠ
                } else {
                    return 'square';   // Ù…Ø±Ø¨Ø¹
                }
            }
            
            return 'square'; // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
        }
        
        /**
         * Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
         */
        function showFilterStatusNotification() {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            hideFilterStatusNotification();
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¦Ø© ÙˆØ§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const category = window.currentCategoryFilter || 'all';
            const dimension = window.currentDimensionFilter || 'all';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            let categoryText = 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª';
            if (category !== 'all') {
                categoryText = document.querySelector(`.filter-btn[data-category="${category}"]`)?.textContent?.trim() || category;
            }
            
            let dimensionText = 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯';
            let dimensionIcon = 'ğŸ”';
            
            if (dimension === 'portrait') {
                dimensionText = 'Ø·ÙˆÙ„ÙŠ';
                dimensionIcon = 'â¬œ';
            } else if (dimension === 'landscape') {
                dimensionText = 'Ø¹Ø±Ø¶ÙŠ';
                dimensionIcon = 'â¬›';
            } else if (dimension === 'square') {
                dimensionText = 'Ù…Ø±Ø¨Ø¹';
                dimensionIcon = 'â—¼ï¸';
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            const notification = document.createElement('div');
            notification.id = 'filter-status-notification';
            notification.innerHTML = `
                <div class="filter-status-content">
                    <div class="filter-status-item">
                        <span class="filter-status-icon">ğŸ“</span>
                        <span class="filter-status-text">${categoryText}</span>
                    </div>
                    <div class="filter-status-item">
                        <span class="filter-status-icon">${dimensionIcon}</span>
                        <span class="filter-status-text">${dimensionText}</span>
                    </div>
                </div>
                <button class="filter-status-close" onclick="hideFilterStatusNotification()">Ã—</button>
            `;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ù…Ø§Ø·
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background-color: rgba(58, 16, 69, 0.9);
                color: white;
                padding: 10px 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-size: 14px;
                max-width: 90%;
                width: auto;
                backdrop-filter: blur(5px);
                border: 1px solid rgba(177, 76, 200, 0.3);
            `;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
            const style = document.createElement('style');
            style.textContent = `
                .filter-status-content {
                    display: flex;
                    flex-direction: column;
                    gap: 5px;
                }
                .filter-status-item {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }
                .filter-status-icon {
                    font-size: 16px;
                }
                .filter-status-text {
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }
                .filter-status-close {
                    background: none;
                    border: none;
                    color: white;
                    font-size: 20px;
                    cursor: pointer;
                    padding: 0 0 0 10px;
                    margin: 0;
                }
            `;
            
            document.head.appendChild(style);
            document.body.appendChild(notification);
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†Ù
            setTimeout(hideFilterStatusNotification, 5000);
        }
        
        /**
         * Ø¥Ø®ÙØ§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
         */
        function hideFilterStatusNotification() {
            const notification = document.getElementById('filter-status-notification');
            if (notification) {
                notification.remove();
            }
        }
        
        // Ø¥ØªØ§Ø­Ø© Ø¯Ø§Ù„Ø© Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.hideFilterStatusNotification = hideFilterStatusNotification;
        
        /**
         * ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
         * ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¨Ø¹Ø© ÙˆØ§Ù„Ø£ÙÙ‚ÙŠØ© Ù„ØªØ£Ø®Ø° Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„ ÙˆØ§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„
         * @param {NodeList} gridItems - Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´Ø¨ÙƒØ©
         */
        function optimizeImagesForWideViewInMobile(gridItems) {
            // ØªØ·Ø¨ÙŠÙ‚ ØªØ®Ø·ÙŠØ· Ù…Ø®ØµØµ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
            
            // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ù…Ø© data-fullwidth
            if (!document.getElementById('fullwidth-image-styles')) {
                const style = document.createElement('style');
                style.id = 'fullwidth-image-styles';
                style.textContent = `
                    @media (max-width: 767px) {
                        .masonry-grid[style*="column-count: 2"] .grid-item[data-fullwidth="true"] {
                            width: 100% !important;
                            column-span: all !important;
                            break-inside: avoid;
                            margin-bottom: 12px !important;
                        }
                        
                        .masonry-grid[style*="column-count: 2"] .grid-item[data-fullwidth="true"] .image-card {
                            width: 100% !important;
                            max-width: 100% !important;
                            border: 2px solid rgba(177, 76, 200, 0.3);
                            box-shadow: 0 4px 15px rgba(177, 76, 200, 0.2);
                            transform: translateY(-3px);
                        }
                        
                        /* Ø¶Ø¨Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„Ø£ÙÙ‚ÙŠØ© 16:9 */
                        .masonry-grid[style*="column-count: 2"] .grid-item[data-ratio="16:9"] .gallery-image {
                            width: 100%;
                            max-height: 220px;
                            object-fit: contain;
                        }
                        
                        /* Ø¶Ø¨Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¨Ø¹Ø© 1:1 */
                        .masonry-grid[style*="column-count: 2"] .grid-item[data-ratio="1:1"] .gallery-image {
                            width: 100%;
                            max-height: 280px;
                            object-fit: contain;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø§Øª ÙÙ‚Ø· ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
            if (window.innerWidth <= 768 && currentViewMode === 'wide') {
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø¨Ø¹Ø§Ø¯Ù‡Ø§
                gridItems.forEach(item => {
                    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ©
                    if (item.style.display === 'none') return;
                    
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø©
                    const imgElement = item.querySelector('img.gallery-image');
                    if (!imgElement) return;
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ù†Ù…Ø§Ø·
                    item.removeAttribute('data-fullwidth');
                    item.removeAttribute('data-ratio');
                    
                    // Ø§ÙƒØªØ´Ø§Ù Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙ‚Ø· Ù„Ù„ØµÙˆØ± Ø§Ù„Ù…Ø­Ù…Ù„Ø©
                    if (imgElement.complete) {
                        const width = imgElement.naturalWidth;
                        const height = imgElement.naturalHeight;
                        
                        if (width && height) {
                            const ratio = width / height;
                            
                            // Ø§Ù„ØµÙˆØ± Ø¨Ù†Ø³Ø¨Ø© 16:9 (Ø¨Ù‡Ø§Ù…Ø´ Ø®Ø·Ø£)
                            if (ratio >= 1.7 && ratio <= 1.8) {
                                item.setAttribute('data-fullwidth', 'true');
                                item.setAttribute('data-ratio', '16:9');
                            }
                            // Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¨Ø¹Ø© Ø¨Ù†Ø³Ø¨Ø© 1:1 (Ø¨Ù‡Ø§Ù…Ø´ Ø®Ø·Ø£)
                            else if (ratio >= 0.9 && ratio <= 1.1) {
                                item.setAttribute('data-fullwidth', 'true');
                                item.setAttribute('data-ratio', '1:1');
                            }
                        }
                    } else {
                        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ ØªØ­Ù…ÙŠÙ„ Ù„Ù„ØµÙˆØ± ØºÙŠØ± Ø§Ù„Ù…Ø­Ù…Ù„Ø©
                        imgElement.addEventListener('load', function() {
                            const width = this.naturalWidth;
                            const height = this.naturalHeight;
                            
                            if (width && height) {
                                const ratio = width / height;
                                
                                // Ø§Ù„ØµÙˆØ± Ø¨Ù†Ø³Ø¨Ø© 16:9 (Ø¨Ù‡Ø§Ù…Ø´ Ø®Ø·Ø£)
                                if (ratio >= 1.7 && ratio <= 1.8) {
                                    item.setAttribute('data-fullwidth', 'true');
                                    item.setAttribute('data-ratio', '16:9');
                                    refreshMasonry();
                                }
                                // Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¨Ø¹Ø© Ø¨Ù†Ø³Ø¨Ø© 1:1 (Ø¨Ù‡Ø§Ù…Ø´ Ø®Ø·Ø£)
                                else if (ratio >= 0.9 && ratio <= 1.1) {
                                    item.setAttribute('data-fullwidth', 'true');
                                    item.setAttribute('data-ratio', '1:1');
                                    refreshMasonry();
                                }
                            }
                        });
                    }
                });
            }
        }

        /**
         * Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
         * @param {Element} masonryGrid - Ø¹Ù†ØµØ± Ø´Ø¨ÙƒØ© Ù…Ø§Ø³ÙˆÙ†Ø±ÙŠ
         */
        function resetGridLayout(masonryGrid) {
            if (masonryGrid) {
                masonryGrid.style.display = '';
                masonryGrid.style.columnCount = '';
                masonryGrid.style.columnGap = '';
                masonryGrid.style.width = '';
            }
        }
        
        // ØªÙ‡ÙŠØ¦Ø© ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function initializeStorage() {
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª
            if (!localStorage.getItem('imageLikes')) {
                localStorage.setItem('imageLikes', '{}');
            }
            if (!localStorage.getItem('userLikes')) {
                localStorage.setItem('userLikes', '[]');
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª
            if (!localStorage.getItem('favorites')) {
                localStorage.setItem('favorites', '[]');
            }
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„ØµÙˆØ±Ø© Ù…Ù† Ø±Ø§Ø¨Ø· URL
        function getImageId(url) {
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
            const parts = url.split('/');
            let filename = parts[parts.length - 1];
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙˆÙ„ Ù…Ø¹Ø±Ù Ø¨ØµÙŠØºØ© UUID
            const uuidPattern = /[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i;
            const match = url.match(uuidPattern);
            
            if (match) {
                return match[0]; // Ø¥Ø±Ø¬Ø§Ø¹ UUID
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ UUIDØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
            if (filename.includes('?')) {
                filename = filename.split('?')[0];
            }
            
            return filename;
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª Ù„ØµÙˆØ±Ø© Ù…Ø¹ÙŠÙ†Ø©
        function getLikesCount(imageUrl) {
            initializeStorage();
            const likes = JSON.parse(localStorage.getItem('imageLikes') || '{}');
            const imageId = getImageId(imageUrl);
            return likes[imageId] || 0;
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙŠ Ø£Ø¹Ø¬Ø¨ Ø¨Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function getUserLikes() {
            initializeStorage();
            return JSON.parse(localStorage.getItem('userLikes') || '[]');
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª
        function getFavorites() {
            initializeStorage();
            return JSON.parse(localStorage.getItem('favorites') || '[]');
        }
        
        // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ Ù„ØµÙˆØ±Ø© Ù…Ø¹ÙŠÙ†Ø©
        function toggleLike(imageUrl, button) {
            console.log("ØªØ¨Ø¯ÙŠÙ„ Ø¥Ø¹Ø¬Ø§Ø¨ Ù„Ù„ØµÙˆØ±Ø©:", imageUrl);
            initializeStorage();
            
            const imageId = getImageId(imageUrl);
            const likes = JSON.parse(localStorage.getItem('imageLikes') || '{}');
            const userLikes = getUserLikes();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ Ø£Ùˆ Ø¨Ø§Ù„Ù…Ø¹Ø±Ù
            let userLikeIndex = userLikes.indexOf(imageUrl);
            if (userLikeIndex === -1) {
                userLikeIndex = userLikes.indexOf(imageId);
            }
            
            const hasLiked = userLikeIndex !== -1;
            console.log(`Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${hasLiked ? 'Ù…Ø¹Ø¬Ø¨' : 'ØºÙŠØ± Ù…Ø¹Ø¬Ø¨'}`);
            
            // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
            if (hasLiked) {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
                userLikes.splice(userLikeIndex, 1);
                likes[imageId] = Math.max(0, (likes[imageId] || 0) - 1);
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ø¬Ø§Ø¨
                userLikes.push(imageId); // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ø±Ù Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ®Ø²ÙŠÙ†
                likes[imageId] = (likes[imageId] || 0) + 1;
            }
            
            // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            localStorage.setItem('imageLikes', JSON.stringify(likes));
            localStorage.setItem('userLikes', JSON.stringify(userLikes));
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø¦ÙŠ
            const newHasLiked = !hasLiked;
            const likeCount = likes[imageId] || 0;
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ ÙˆØ§Ù„Ø¹Ø¯Ø¯
            const likeIcon = button.querySelector('.fa-heart');
            const countElement = button.nextElementSibling;
            
            if (likeIcon) {
                if (newHasLiked) {
                    button.classList.add('active');
                    likeIcon.style.color = 'white';
                    likeIcon.style.webkitTextStroke = '0';
                } else {
                    button.classList.remove('active');
                    likeIcon.style.color = 'transparent';
                    likeIcon.style.webkitTextStroke = '1px white';
                }
                
                button.classList.add('pulse');
                setTimeout(() => button.classList.remove('pulse'), 500);
            }
            
            if (countElement) {
                countElement.textContent = likeCount;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„ØµÙˆØ±Ø© Ù†ÙØ³Ù‡Ø§
            document.querySelectorAll(`.like-btn[data-url="${imageUrl}"]`).forEach(btn => {
                if (btn !== button) {
                    const btnIcon = btn.querySelector('.fa-heart');
                    const btnCount = btn.nextElementSibling;
                    
                    if (btnIcon) {
                        if (newHasLiked) {
                            btn.classList.add('active');
                            btnIcon.style.color = 'white';
                            btnIcon.style.webkitTextStroke = '0';
                        } else {
                            btn.classList.remove('active');
                            btnIcon.style.color = 'transparent';
                            btnIcon.style.webkitTextStroke = '1px white';
                        }
                    }
                    
                    if (btnCount) {
                        btnCount.textContent = likeCount;
                    }
                }
            });
            
            return likeCount;
        }
        
        // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„ØµÙˆØ±Ø© Ù…Ø¹ÙŠÙ†Ø©
        function toggleFavorite(imageUrl, button) {
            console.log("ØªØ¨Ø¯ÙŠÙ„ Ù…ÙØ¶Ù„Ø© Ù„Ù„ØµÙˆØ±Ø©:", imageUrl);
            
            const imageId = getImageId(imageUrl);
            const favorites = getFavorites();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ø£ÙˆÙ„Ø§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…)
            let favoriteIndex = favorites.indexOf(imageUrl);
            let isFavorite = favoriteIndex !== -1;
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©ØŒ Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø±Ù Ø§Ù„ØµÙˆØ±Ø©
            if (!isFavorite) {
                favoriteIndex = favorites.indexOf(imageId);
                isFavorite = favoriteIndex !== -1;
            }
            
            // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©
            if (isFavorite) {
                // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©
                favorites.splice(favoriteIndex, 1);
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø© - Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ø±Ù Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„
                favorites.push(imageId);
            }
            
            // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            localStorage.setItem('favorites', JSON.stringify(favorites));
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø¦ÙŠ
            const newIsFavorite = !isFavorite;
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©
            const favoriteIcon = button.querySelector('.fa-bookmark');
            
            if (favoriteIcon) {
                if (newIsFavorite) {
                    button.classList.add('active');
                    favoriteIcon.style.color = 'white';
                    favoriteIcon.style.webkitTextStroke = '0';
                } else {
                    button.classList.remove('active');
                    favoriteIcon.style.color = 'transparent';
                    favoriteIcon.style.webkitTextStroke = '1px white';
                }
                
                button.classList.add('pulse');
                setTimeout(() => button.classList.remove('pulse'), 500);
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„ØµÙˆØ±Ø© Ù†ÙØ³Ù‡Ø§
            document.querySelectorAll(`.favorite-btn[data-url="${imageUrl}"]`).forEach(btn => {
                if (btn !== button) {
                    const btnIcon = btn.querySelector('.fa-bookmark');
                    
                    if (btnIcon) {
                        if (newIsFavorite) {
                            btn.classList.add('active');
                            btnIcon.style.color = 'white';
                            btnIcon.style.webkitTextStroke = '0';
                        } else {
                            btn.classList.remove('active');
                            btnIcon.style.color = 'transparent';
                            btnIcon.style.webkitTextStroke = '1px white';
                        }
                    }
                }
            });
            
            return newIsFavorite;
        }
        
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙˆØ±Ø© ÙƒØµÙˆØ±Ø© Ù…Ù„Ù Ø´Ø®ØµÙŠ
        function setProfileImage(imageUrl) {
            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ù…Ø¨Ø§Ø´Ø±Ø©
            showProfileImageConfirmation(imageUrl);
            return true;
        }
        
        /**
         * Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± ØªØ£ÙƒÙŠØ¯ Ù…Ø®ØµØµ Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
         * @param {string} imageUrl - Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ ÙƒØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ©
         */
        function showProfileImageConfirmation(imageUrl) {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const currentLang = localStorage.getItem('language') || 'ar';
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
            const texts = currentLang === 'en' ? {
                title: 'Change Profile Picture',
                message: 'Are you sure you want to set this image as your profile picture?',
                confirmButton: 'Yes, Change it',
                cancelButton: 'Cancel'
            } : {
                title: 'ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©',
                message: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ ØªØ¹ÙŠÙŠÙ† Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© ÙƒØµÙˆØ±Ø© Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠØŸ',
                confirmButton: 'Ù†Ø¹Ù…ØŒ Ù‚Ù… Ø¨Ø§Ù„ØªØºÙŠÙŠØ±',
                cancelButton: 'Ø¥Ù„ØºØ§Ø¡'
            };
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø®Ù„ÙÙŠØ©
            const confirmOverlay = document.createElement('div');
            confirmOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                backdrop-filter: blur(3px);
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© Ù…ØµØºØ±Ø© Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªØ£ÙƒÙŠØ¯
            const thumbnailContainer = document.createElement('div');
            thumbnailContainer.style.cssText = `
                width: 120px;
                height: 120px;
                border-radius: 50%;
                overflow: hidden;
                margin: 0 auto 20px auto;
                border: 3px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ØµØºØ±Ø©
            const thumbnail = document.createElement('img');
            thumbnail.style.cssText = `
                width: 100%;
                height: 100%;
                object-fit: cover;
            `;
            thumbnail.src = imageUrl;
            thumbnailContainer.appendChild(thumbnail);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø­ÙˆØ§Ø±
            const confirmBox = document.createElement('div');
            confirmBox.style.cssText = `
                background: linear-gradient(135deg, rgba(25, 5, 30, 0.95), rgba(45, 15, 50, 0.95));
                border: 1px solid rgba(255, 255, 255, 0.15);
                border-radius: 15px;
                padding: 25px;
                max-width: 400px;
                text-align: center;
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
                transform: translateY(20px);
                opacity: 0;
                transition: all 0.3s ease;
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø¸Ù‡ÙˆØ±
            setTimeout(() => {
                confirmBox.style.transform = 'translateY(0)';
                confirmBox.style.opacity = '1';
            }, 50);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            const title = document.createElement('h3');
            title.textContent = texts.title;
            title.style.cssText = `
                color: #d5c3e8;
                margin: 0 0 20px 0;
                font-size: 22px;
                font-weight: 600;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const message = document.createElement('p');
            message.textContent = texts.message;
            message.style.cssText = `
                color: rgba(255, 255, 255, 0.85);
                margin: 0 0 25px 0;
                line-height: 1.6;
                font-size: 16px;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                display: flex;
                justify-content: center;
                gap: 15px;
                ${currentLang === 'ar' ? 'flex-direction: row-reverse;' : ''}
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯
            const confirmButton = document.createElement('button');
            confirmButton.textContent = texts.confirmButton;
            confirmButton.style.cssText = `
                background: linear-gradient(45deg, #9c65a3, #ba7fc2);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(186, 127, 194, 0.3);
            `;
            
            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø²Ø±
            confirmButton.addEventListener('mouseenter', () => {
                confirmButton.style.transform = 'translateY(-2px)';
                confirmButton.style.boxShadow = '0 6px 15px rgba(186, 127, 194, 0.4)';
            });
            
            confirmButton.addEventListener('mouseleave', () => {
                confirmButton.style.transform = 'translateY(0)';
                confirmButton.style.boxShadow = '0 4px 12px rgba(186, 127, 194, 0.3)';
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡
            const cancelButton = document.createElement('button');
            cancelButton.textContent = texts.cancelButton;
            cancelButton.style.cssText = `
                background: rgba(255, 255, 255, 0.1);
                color: rgba(255, 255, 255, 0.8);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            `;
            
            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡
            cancelButton.addEventListener('mouseenter', () => {
                cancelButton.style.background = 'rgba(255, 255, 255, 0.15)';
            });
            
            cancelButton.addEventListener('mouseleave', () => {
                cancelButton.style.background = 'rgba(255, 255, 255, 0.1)';
            });
            
            // Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø­ÙˆØ§Ø±
            const closeConfirmDialog = () => {
                confirmBox.style.transform = 'translateY(20px)';
                confirmBox.style.opacity = '0';
                
                setTimeout(() => {
                    document.body.removeChild(confirmOverlay);
                }, 300);
            };
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            confirmButton.addEventListener('click', () => {
                closeConfirmDialog();
                // ØªÙ†ÙÙŠØ° ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
                applyProfileImageChange(imageUrl);
            });
            
            cancelButton.addEventListener('click', closeConfirmDialog);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø­Ø¯Ø« Ù„Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø­ÙˆØ§Ø±
            confirmOverlay.addEventListener('click', (e) => {
                if (e.target === confirmOverlay) {
                    closeConfirmDialog();
                }
            });
            
            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
            buttonContainer.appendChild(confirmButton);
            buttonContainer.appendChild(cancelButton);
            
            confirmBox.appendChild(thumbnailContainer);
            confirmBox.appendChild(title);
            confirmBox.appendChild(message);
            confirmBox.appendChild(buttonContainer);
            confirmOverlay.appendChild(confirmBox);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø­ÙˆØ§Ø± Ù„Ù„ØµÙØ­Ø©
            document.body.appendChild(confirmOverlay);
        }
        
        /**
         * ØªØ·Ø¨ÙŠÙ‚ ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
         * @param {string} imageUrl - Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ¹ÙŠÙŠÙ†Ù‡Ø§
         */
        function applyProfileImageChange(imageUrl) {
            // ØªØ®Ø²ÙŠÙ† Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ localStorage
            localStorage.setItem('userAvatar', imageUrl);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            const userAvatar = document.getElementById('user-avatar');
            if (userAvatar) {
                userAvatar.src = imageUrl;
            }
            
            // ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const userName = document.getElementById('user-name');
            if (userName && (!userName.textContent || userName.textContent === 'Ø²Ø§Ø¦Ø±')) {
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„Ø§Ù‹ØŒ Ø£Ù†Ø´Ø¦ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ
                const defaultUsername = 'Ù…Ø³ØªØ®Ø¯Ù…_' + Math.floor(Math.random() * 1000);
                userName.textContent = defaultUsername;
                
                // Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                currentUser.username = defaultUsername;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
            
            // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­ Ù…Ø®ØµØµ
            const currentLang = localStorage.getItem('language') || 'ar';
            const successText = currentLang === 'en' ? 
                'Profile picture updated successfully!' : 
                'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­ ØµØºÙŠØ± Ø¨ØªØµÙ…ÙŠÙ… Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹
            const successNotification = document.createElement('div');
            successNotification.style.cssText = `
                position: fixed;
                bottom: 20px;
                ${currentLang === 'ar' ? 'left: 20px;' : 'right: 20px;'}
                background: linear-gradient(45deg, #4a8a5e, #60b275);
                color: white;
                padding: 12px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                font-size: 14px;
                opacity: 0;
                transform: translateY(20px);
                transition: all 0.3s ease;
            `;
            
            successNotification.textContent = successText;
            document.body.appendChild(successNotification);
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            setTimeout(() => {
                successNotification.style.opacity = '1';
                successNotification.style.transform = 'translateY(0)';
            }, 100);
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                successNotification.style.opacity = '0';
                successNotification.style.transform = 'translateY(20px)';
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù…Ù† DOM Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
                setTimeout(() => {
                    document.body.removeChild(successNotification);
                }, 300);
            }, 3000);
        }
        
        // Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙˆØ±Ø©
        function shareImage(url, title) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: 'Ø´Ø§Ù‡Ø¯ Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø§Ø¦Ø¹Ø© Ù…Ù† Ù…Ø¹Ø±Ø¶ ArtWall.Ai',
                    url: url
                })
                .then(() => console.log('ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­'))
                .catch((error) => console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:', error));
            } else {
                // Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ¯Ø¹Ù… Share API
                const tempInput = document.createElement('input');
                document.body.appendChild(tempInput);
                tempInput.value = url;
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©. ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ø±ÙƒØªÙ‡ Ø§Ù„Ø¢Ù†.');
            }
        }
        
        // ÙˆØ¸ÙŠÙØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Ø§Ù„ÙØ¦Ø© Ù„Ù„ØªØ±Ø¬Ù…Ø©
        function getCategoryKey(category) {
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØ¦Ø© Ø¥Ù„Ù‰ Ù…ÙØªØ§Ø­ Ù…Ù†Ø§Ø³Ø¨ ÙÙŠ ÙƒØ§Ø¦Ù† Ø§Ù„ØªØ±Ø¬Ù…Ø©
            const categoryMap = {
                'animals': 'animals',
                'Ø­ÙŠÙˆØ§Ù†Ø§Øª': 'animals',
                'birds': 'birds',
                'Ø·ÙŠÙˆØ±': 'birds',
                'anime': 'anime',
                'Ø£Ù†Ù…ÙŠ': 'anime',
                'creativity': 'creativity',
                'Ø¥Ø¨Ø¯Ø§Ø¹': 'creativity',
                'technology': 'technology',
                'ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§': 'technology',
                'world': 'world',
                'Ø¹Ø§Ù„Ù…': 'world',
                'space': 'space',
                'ÙØ¶Ø§Ø¡': 'space',
                'classic': 'classic',
                'ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ': 'classic',
                'all': 'allImages',
                'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±': 'allImages'
            };
            
            // Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø£Ùˆ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
            return categoryMap[category.toLowerCase()] || category;
        }
        
        // ÙˆØ¸ÙŠÙØ© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØµÙˆØ±
        function searchImages(query) {
            console.log('Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†:', query);
            query = query.trim().toLowerCase();
            
            if (!query) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« ÙØ§Ø±ØºØ§Ù‹ØŒ Ø£Ø¹Ø¯ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                applyFilters();
                return;
            }
            
            const currentLang = localStorage.getItem('language') || 'ar';
            const gridItems = document.querySelectorAll('.grid-item');
            
            gridItems.forEach(item => {
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙƒÙ„ØªØ§ Ø§Ù„Ù„ØºØªÙŠÙ†
                const titleAr = item.getAttribute('data-title-ar')?.toLowerCase() || '';
                const titleEn = item.getAttribute('data-title-en')?.toLowerCase() || '';
                const categoryAr = item.getAttribute('data-category-ar')?.toLowerCase() || '';
                const categoryEn = item.getAttribute('data-category-en')?.toLowerCase() || '';
                
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù„ØºØªÙŠÙ†
                const titleMatch = titleAr.includes(query) || titleEn.includes(query);
                const categoryMatch = categoryAr.includes(query) || categoryEn.includes(query);
                
                // Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¨Ø­Ø«
                if (titleMatch || categoryMatch) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø¨Ø¹Ø¯ Ø§Ù„Ø¨Ø­Ø«
            refreshMasonry();
        }
        
        // ØªØ±Ø¬Ù…Ø§Øª Ù„Ù†ØµÙˆØµ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        const translations = {
            ar: {
                // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
                myAccount: 'Ø­Ø³Ø§Ø¨ÙŠ',
                home: 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                myProfile: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ',
                myFavorites: 'Ø§Ù„Ù…ÙØ¶Ù„Ø©',
                imageDimensions: 'Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±',
                viewMode: 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶',
                tools: 'Ø£Ø¯ÙˆØ§Øª',
                language: 'Ø§Ù„Ù„ØºØ©',
                
                // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
                allImages: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±',
                animals: 'Ø­ÙŠÙˆØ§Ù†Ø§Øª',
                birds: 'Ø·ÙŠÙˆØ±',
                anime: 'Ø£Ù†Ù…ÙŠ',
                creativity: 'Ø¥Ø¨Ø¯Ø§Ø¹',
                technology: 'ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§',
                world: 'Ø¹Ø§Ù„Ù…',
                space: 'ÙØ¶Ø§Ø¡',
                classic: 'ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ',
                
                // Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
                searchPlaceholder: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… ØµÙˆØ±Ø©...'
            },
            en: {
                // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
                myAccount: 'My Account',
                home: 'Home',
                myProfile: 'My Profile',
                myFavorites: 'Favorites',
                imageDimensions: 'Image Dimensions',
                viewMode: 'View Mode',
                tools: 'Tools',
                language: 'Language',
                
                // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
                allImages: 'All Images',
                animals: 'Animals',
                birds: 'Birds',
                anime: 'Anime',
                creativity: 'Creativity',
                technology: 'Technology',
                world: 'World',
                space: 'Space',
                classic: 'Classic',
                
                // Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
                searchPlaceholder: 'Search for an image name...'
            }
        };
        
        // ÙˆØ¸ÙŠÙØ© ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© (Ù…Ø¨Ø³Ø·Ø©)
        function switchLanguage(lang) {
            console.log('ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰:', lang);
            
            // ØªØ­Ø¯ÙŠØ« Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„ØºØ©
            document.querySelectorAll('.lang-option').forEach(option => {
                if (option.getAttribute('data-lang') === lang) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù„ØºØ© ÙÙŠ localStorage
            localStorage.setItem('language', lang);
            
            // ØªØ­Ø¯ÙŠØ« Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
            const langMenu = document.getElementById('languageMenu');
            if (langMenu) {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµØ§Ø¦Øµ Ù„Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
                setTimeout(() => {
                    if (langMenu.offsetHeight > 0) {
                        // Ø¶Ù…Ø§Ù† Ø£Ù† Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© ØªØºØ·ÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                        const menuWidth = langMenu.offsetWidth;
                        const menuHeight = langMenu.offsetHeight;
                        langMenu.style.setProperty('--menu-width', menuWidth + 'px');
                        langMenu.style.setProperty('--menu-height', menuHeight + 'px');
                    }
                }, 50); // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù…
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
            var menu = document.getElementById('languageMenu');
            if (menu) {
                menu.classList.remove('show');
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
            applyTranslations(lang);
            
            // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± Ø§Ù„Ù„ØºØ©
            const langText = document.querySelector('#langToggleBtn span[data-i18n="language"]');
            if (langText) {
                langText.textContent = translations[lang]['language'] || (lang === 'ar' ? 'Ø§Ù„Ù„ØºØ©' : 'Language');
            }
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
        function applyTranslations(lang) {
            const texts = translations[lang] || translations.ar;
            
            // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø³Ù…Ø© data-i18n
            document.querySelectorAll('[data-i18n]').forEach(elem => {
                const key = elem.getAttribute('data-i18n');
                if (texts[key]) {
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ØµØ± Ø²Ø± ØªØµÙÙŠØ© Ø¨Ù‡ Ø£ÙŠÙ‚ÙˆÙ†Ø©
                    if (elem.classList.contains('filter-btn')) {
                        // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± Ø§Ù„Ù†Øµ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø²Ø± ÙˆØ§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
                        const textSpan = elem.querySelector('.category-text');
                        if (textSpan) {
                            textSpan.textContent = texts[key];
                        } else {
                            elem.textContent = texts[key];
                        }
                    } else {
                        // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© Ø§Ù„Ø£Ø®Ø±Ù‰
                        elem.textContent = texts[key];
                    }
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« placeholder Ù„Ù„Ø­Ù‚ÙˆÙ„
            document.querySelectorAll('[data-i18n-placeholder]').forEach(elem => {
                const key = elem.getAttribute('data-i18n-placeholder');
                if (texts[key]) {
                    elem.placeholder = texts[key];
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙØ¦Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            document.querySelectorAll('.grid-item').forEach(item => {
                // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø©
                const titleBadge = item.querySelector('.image-title-badge');
                if (titleBadge) {
                    const titleKey = lang === 'ar' ? 'data-title-ar' : 'data-title-en';
                    const title = item.getAttribute(titleKey) || '';
                    if (title) {
                        titleBadge.textContent = title;
                        titleBadge.setAttribute('title', title);
                    }
                }
                
                // ØªØ­Ø¯ÙŠØ« ÙØ¦Ø© Ø§Ù„ØµÙˆØ±Ø©
                const categoryBadge = item.querySelector('.category-badge');
                if (categoryBadge) {
                    const categoryKey = lang === 'ar' ? 'data-category-ar' : 'data-category-en';
                    const category = item.getAttribute(categoryKey) || '';
                    if (category) {
                        categoryBadge.textContent = category;
                    }
                }
            });
        }
        
        // ÙˆØ¸ÙŠÙØ© ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© (Ù…Ø¨Ø³Ø·Ø© Ù„Ù„ØºØ§ÙŠØ©)
        function initLanguageDropdown() {
            console.log('ØªÙ‡ÙŠØ¦Ø© Ø²Ø± Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø³ÙŠØ·');
            
            // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            var langBtn = document.getElementById('langToggleBtn');
            var menu = document.getElementById('languageMenu');
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù„ØºØ©
            if (langBtn && menu) {
                // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†Ù‚Ø±Ø§Øª Ø²Ø± Ø§Ù„Ù„ØºØ©
                langBtn.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶');
                    
                    // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                    if (menu.classList.contains('show')) {
                        menu.classList.remove('show');
                    } else {
                        // ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¬Ø¨ Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙˆÙ‚ Ø£Ù… ØªØ­Øª Ø§Ù„Ø²Ø±
                        const btnRect = langBtn.getBoundingClientRect();
                        const bottomSpace = window.innerHeight - btnRect.bottom;
                        
                        // ØªÙ‚Ø¯ÙŠØ± Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª (ÙƒÙ„ Ù„ØºØ© ~40px)
                        const itemCount = menu.querySelectorAll('a').length;
                        const estimatedMenuHeight = itemCount * 40 + 10; // 10px Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù‡ÙˆØ§Ù…Ø´
                        
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ù‚Ø¯Ø± Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©ØŒ Ø£Ùˆ Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø­Ø§ÙØ© Ø§Ù„Ø´Ø§Ø´Ø©ØŒ Ø¹Ø±Ø¶Ù‡Ø§ ÙÙˆÙ‚ Ø§Ù„Ø²Ø±
                        const safetyMargin = 20; // Ù‡Ø§Ù…Ø´ Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠ Ø¨Ø§Ù„Ø¨ÙŠÙƒØ³Ù„
                        if (bottomSpace < estimatedMenuHeight + safetyMargin || 
                            btnRect.bottom + estimatedMenuHeight > window.innerHeight - safetyMargin) {
                            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙˆÙ‚ Ø§Ù„Ø²Ø±
                            menu.style.bottom = '100%';
                            menu.style.top = 'auto';
                            menu.style.marginBottom = '5px';
                            menu.style.marginTop = '0';
                            // ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù…Ù† Ø£Ø¹Ù„Ù‰
                            menu.style.animation = 'fadeInFromTop 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                            // Ø¥Ø¶Ø§ÙØ© Ø³Ù…Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙˆØ¶Ø¹
                            menu.setAttribute('data-position', 'top');
                        } else {
                            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªØ­Øª Ø§Ù„Ø²Ø± (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)
                            menu.style.top = '100%';
                            menu.style.bottom = 'auto';
                            menu.style.marginTop = '5px';
                            menu.style.marginBottom = '0';
                            // ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù…Ù† Ø£Ø³ÙÙ„
                            menu.style.animation = 'fadeInFromBottom 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                            // Ø¥Ø¶Ø§ÙØ© Ø³Ù…Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙˆØ¶Ø¹
                            menu.setAttribute('data-position', 'bottom');
                        }
                        
                        // Ø¬Ø¹Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø³Ø§ÙˆÙŠÙ‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø²Ø±
                        menu.style.width = btnRect.width + 'px';
                        
                        menu.classList.add('show');
                    }
                };
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
                document.onclick = function(e) {
                    if (e.target != langBtn && !menu.contains(e.target)) {
                        menu.classList.remove('show');
                    }
                };
                
                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                const currentLang = localStorage.getItem('language') || 'ar';
                document.querySelectorAll('.lang-option').forEach(option => {
                    if (option.getAttribute('data-lang') === currentLang) {
                        option.classList.add('active');
                    } else {
                        option.classList.remove('active');
                    }
                });
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // ØªÙ‡ÙŠØ¦Ø© Ø°Ø§ÙƒØ±Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            initializeStorage();
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            
            // ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
            const storedAvatar = localStorage.getItem('userAvatar');
            if (storedAvatar) {
                userAvatar.src = storedAvatar;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„Ø§Ù‹
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (currentUser && currentUser.username) {
                userName.textContent = currentUser.username;
            } else {
                userName.textContent = 'Ø²Ø§Ø¦Ø±';
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            initMenuToggle();
            
            // ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
            initLanguageDropdown();
            
            // ØªÙ‡ÙŠØ¦Ø© Ø²Ø± ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª - Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ A
            initFilterToggle();
            
            // ØªÙ‡ÙŠØ¦Ø© ÙÙ„Ø§ØªØ± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙˆØ§Ù„ÙØ¦Ø§Øª
            window.currentCategoryFilter = 'all';
            window.currentDimensionFilter = 'all';
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    switchLanguage(this.getAttribute('data-lang'));
                });
            });
            
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            const savedViewMode = localStorage.getItem('viewMode') || 'default';
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ù…Ø¹ ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ ÙƒØ§ÙØ© Ø§Ù„ØµÙˆØ±
            setTimeout(() => {
                setGridColumns(savedViewMode);
                
                // ØªØ­Ø¯ÙŠØ« Masonry Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ù‚ØµÙŠØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
                setTimeout(() => {
                    refreshMasonry();
                }, 200);
            }, 100);
            
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø£Ùˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            const savedLang = localStorage.getItem('language') || 'ar';
            switchLanguage(savedLang);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø­Ø¯Ø« Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                // Ù…Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
                searchInput.addEventListener('input', function() {
                    searchImages(this.value);
                });
                
                // Ù…Ø³ØªÙ…Ø¹ Ù„Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Enter
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchImages(this.value);
                    }
                });
            }
            
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙˆØ±
            if (!window.imageData || !Array.isArray(window.imageData)) {
                console.error('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙˆØ± ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©!');
                return;
            }
            
            console.log('ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰', window.imageData.length, 'ØµÙˆØ±Ø©ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ø±Ø¶
            const masonryGrid = document.querySelector('.masonry-grid');
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙˆØ±
            window.imageData.forEach(imageData => {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØµÙˆØ±Ø©
                const gridItem = document.createElement('div');
                gridItem.className = 'grid-item';
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                let title = '';
                if (typeof imageData.title === 'object') {
                    // Ø§Ø­ÙØ¸ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø© Ø¨ÙƒÙ„ØªØ§ Ø§Ù„Ù„ØºØªÙŠÙ† ÙƒØ³Ù…Ø§Øª Ù„Ù„Ø¹Ù†ØµØ±
                    gridItem.setAttribute('data-title-ar', imageData.title.ar || '');
                    gridItem.setAttribute('data-title-en', imageData.title.en || '');
                    
                    // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                    const currentLang = localStorage.getItem('language') || 'ar';
                    title = imageData.title[currentLang] || imageData.title.ar || imageData.title.en || imageData.alt || 'ØµÙˆØ±Ø©';
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù†ØµÙ‹Ø§ Ø¨Ø³ÙŠØ·Ù‹Ø§ØŒ Ø§Ø­ÙØ¸Ù‡ Ø¨Ù†ÙØ³ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„ÙƒÙ„ØªØ§ Ø§Ù„Ù„ØºØªÙŠÙ†
                    const simpleTitle = imageData.title || imageData.alt || 'ØµÙˆØ±Ø©';
                    gridItem.setAttribute('data-title-ar', simpleTitle);
                    gridItem.setAttribute('data-title-en', simpleTitle);
                    title = simpleTitle;
                }
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙØ¦Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                let category = '';
                if (imageData.category) {
                    // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙØ¦Ø© ÙƒÙƒØ§Ø¦Ù† Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª
                    if (typeof imageData.category === 'object') {
                        // Ø§Ø­ÙØ¸ Ø§Ù„ÙØ¦Ø© Ø¨ÙƒÙ„ØªØ§ Ø§Ù„Ù„ØºØªÙŠÙ† ÙƒØ³Ù…Ø§Øª Ù„Ù„Ø¹Ù†ØµØ±
                        gridItem.setAttribute('data-category-ar', imageData.category.ar || '');
                        gridItem.setAttribute('data-category-en', imageData.category.en || '');
                        
                        // Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                        const currentLang = localStorage.getItem('language') || 'ar';
                        category = imageData.category[currentLang] || imageData.category.ar || imageData.category.en || '';
                    } else {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙØ¦Ø© Ù†ØµÙ‹Ø§ Ø¨Ø³ÙŠØ·Ù‹Ø§
                        const rawCategory = imageData.category.toLowerCase();
                        
                        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù‚Ø¨Ù„ Ø£ÙŠ Ø´Ø±Ø·Ø©
                        const categoryMatch = rawCategory.match(/^([^-]+)/);
                        if (categoryMatch) {
                            category = categoryMatch[1].trim();
                        } else {
                            category = rawCategory;
                        }
                        
                        // ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙØ¦Ø©
                        const categoryKey = getCategoryKey(category);
                        
                        // Ø§Ø­ÙØ¸ Ø§Ù„ÙØ¦Ø© Ø¨ÙƒÙ„ØªØ§ Ø§Ù„Ù„ØºØªÙŠÙ†
                        gridItem.setAttribute('data-category-ar', translations.ar[categoryKey] || category);
                        gridItem.setAttribute('data-category-en', translations.en[categoryKey] || category);
                        
                        // Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                        const currentLang = localStorage.getItem('language') || 'ar';
                        category = translations[currentLang][categoryKey] || category;
                    }
                    
                    // Ø§Ø³ØªØ®Ø¯Ù… Ù‚ÙŠÙ…Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙƒÙ…Ø¹Ø±Ù Ù„Ù„ÙÙ„ØªØ±Ø©
                    const filterCategory = typeof imageData.category === 'object' 
                        ? getCategoryKey(imageData.category.ar || imageData.category.en || '')
                        : getCategoryKey(imageData.category);
                    
                    gridItem.setAttribute('data-category', filterCategory);
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ ÙˆØ§Ù„Ù…ÙØ¶Ù„Ø©
                const imageId = getImageId(imageData.url);
                const likesCount = getLikesCount(imageData.url);
                const userLikes = getUserLikes();
                const favorites = getFavorites();
                
                const hasLiked = userLikes.includes(imageId) || userLikes.includes(imageData.url);
                const isFavorite = favorites.includes(imageId) || favorites.includes(imageData.url);
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø¹Ù†ØµØ± Ù„ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµÙÙŠØ©
                gridItem.setAttribute('data-id', imageId);
                
                // Ø¥Ø¶Ø§ÙØ© Ø³Ù…Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ù„Ø¹Ù†ØµØ± Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙÙ„ØªØ±Ø©
                if (imageData.dimension) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
                    gridItem.setAttribute('data-dimension', imageData.dimension);
                    console.log(`ØªØ¹ÙŠÙŠÙ† Ø¨ÙØ¹Ø¯ Ù„Ù„ØµÙˆØ±Ø© ${title}: ${imageData.dimension}`);
                } else {
                    // Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø¨Ø¹Ø§Ø¯ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø³Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙÙ„ØªØ± Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠ
                    console.log(`Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ù„ØµÙˆØ±Ø©: ${title}`);
                }
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                gridItem.innerHTML = `
                    <div class="image-card">
                        <div class="image-header">
                            <div class="category-badge">${category}</div>
                            <div class="image-title-badge" title="${title}">${title}</div>
                        </div>
                        
                        <div class="left-actions">
                            <button class="action-btn view-btn" onclick="viewImage('${imageData.url}', '${title}')" title="Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn like-btn ${hasLiked ? 'active' : ''}" data-url="${imageData.url}" onclick="toggleLike('${imageData.url}', this)" title="Ø¥Ø¹Ø¬Ø§Ø¨">
                                <i class="fas fa-heart" style="${hasLiked ? 'color: white; -webkit-text-stroke: 0;' : 'color: transparent; -webkit-text-stroke: 1px white;'}"></i>
                            </button>
                            <span class="like-count">${likesCount}</span>
                        </div>
                        
                        <img 
                            src="${imageData.url}" 
                            alt="${imageData.alt || title}" 
                            class="gallery-image"
                            loading="lazy"
                            onerror="this.src='Imges/All img icon.png'; this.style.padding='20px'; this.style.backgroundColor='#1a0b20';"
                        />
                        
                        <div class="bottom-actions">
                            <button class="action-btn share-btn" onclick="shareImage('${imageData.url}', '${title}')" title="Ù…Ø´Ø§Ø±ÙƒØ©">
                                <i class="fas fa-share-alt"></i>
                            </button>
                            <button class="action-btn download-btn" onclick="window.downloadImage(event, '${imageData.url}')" title="ØªÙ†Ø²ÙŠÙ„">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn profile-btn" onclick="setProfileImage('${imageData.url}')" title="ØªØ¹ÙŠÙŠÙ† ÙƒØµÙˆØ±Ø© Ù…Ù„Ù Ø´Ø®ØµÙŠ">
                                <i class="fas fa-user"></i>
                            </button>
                            <button class="action-btn favorite-btn ${isFavorite ? 'active' : ''}" data-url="${imageData.url}" onclick="toggleFavorite('${imageData.url}', this)" title="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©">
                                <i class="fas fa-bookmark" style="${isFavorite ? 'color: white; -webkit-text-stroke: 0;' : 'color: transparent; -webkit-text-stroke: 1px white;'}"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ©
                masonryGrid.appendChild(gridItem);
            });
            
            // ØªØ·Ø¨ÙŠÙ‚ Masonry Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±
            imagesLoaded(masonryGrid, function() {
                new Masonry(masonryGrid, {
                    itemSelector: '.grid-item',
                    columnWidth: '.grid-sizer',
                    gutter: '.gutter-sizer',
                    percentPosition: true
                });
                
                console.log('ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Masonry Ø¨Ù†Ø¬Ø§Ø­');
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙÙŠØ©
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filterCategory = this.getAttribute('data-category');
                    filterByCategory(filterCategory);
                });
            });
        });
        
        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø¹Ø±Ø¶ ÙƒØ§Ù…Ù„ Ø§Ù„Ø´Ø§Ø´Ø©
        function viewImage(url, title) {
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙˆØ±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©
            let imageCategory = '';
            const currentImageData = window.imageData.find(img => img.url === url);
            
            if (currentImageData && currentImageData.category) {
                // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªÙ†Ø³ÙŠÙ‚ "Ù†ÙˆØ¹ - ÙØ¦Ø© ÙØ±Ø¹ÙŠØ©"
                if (typeof currentImageData.category === 'string' && currentImageData.category.includes(' - ')) {
                    const categoryParts = currentImageData.category.split(' - ');
                    imageCategory = categoryParts[0]; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙ‚Ø·
                } else {
                    imageCategory = currentImageData.category;
                }
            }
            
            const viewer = document.createElement('div');
            viewer.className = 'fullscreen-viewer';
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¯Ø§Ù„Ø© Ù…ØªÙˆÙØ±Ø©
            let likesCount = 0;
            if (typeof window.getLikesCount === 'function') {
                likesCount = window.getLikesCount(url);
            }
            
            // Ù…Ø¹Ø±ÙØ© Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ Ø£Ø¹Ø¬Ø¨ Ø¨Ø§Ù„ØµÙˆØ±Ø©
            const hasLiked = typeof window.getUserLikes === 'function' && window.getUserLikes().includes(url);
            
            // Ù…Ø¹Ø±ÙØ© Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©
            const isFavorite = typeof window.getFavorites === 'function' && window.getFavorites().includes(url);
            
            // Ø£ÙˆÙ„Ø§Ù‹ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ø±Ø¶
            viewer.innerHTML = `
                <div class="viewer-content" style="position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                    
                    <!-- Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø£Ø¹Ù„Ù‰ ÙŠÙ…ÙŠÙ† Ø§Ù„Ø´Ø§Ø´Ø© -->
                    <button class="close-btn" style="position: fixed; top: 20px; right: 20px; background-color: rgba(0,0,0,0.7); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 9999;">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ -->
                    <div class="image-info" style="display: flex; flex-direction: column; align-items: center; margin-bottom: 15px; margin-top: 70px; z-index: 100;">
                        <div class="category-badge" style="background-color: rgba(177, 76, 200, 0.8); color: white; padding: 4px 10px; border-radius: 4px; font-size: 14px; text-align: center; backdrop-filter: blur(2px); margin-bottom: 5px;">
                            ${imageCategory || 'Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ'}
                        </div>
                        
                        <div class="image-title-badge" style="background-color: rgba(0, 0, 0, 0.6); color: white; padding: 4px 10px; border-radius: 4px; font-size: 14px; text-align: center; backdrop-filter: blur(2px); max-width: 400px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                            ${title}
                        </div>
                    </div>
                    
                    <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© -->
                    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; margin-bottom: 30px;">
                        <img src="${url}" alt="${title}" class="viewer-image" style="max-width: 85%; max-height: 60vh; object-fit: contain; margin: 0 auto; display: block; border-radius: 8px; box-shadow: 0 5px 20px rgba(0,0,0,0.4);" />
                    </div>
                    
                    <!-- Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ Ø£Ø³ÙÙ„ Ø§Ù„ØµÙˆØ±Ø© - ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ÙˆØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙˆØ¶Ø¹ -->
                    <div class="all-image-actions" style="display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 12px; margin-top: 10px; background-color: rgba(90, 24, 107, 0.7); padding: 10px 15px; border-radius: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); z-index: 100; direction: ltr; /* ØªØ«Ø¨ÙŠØª Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§Ù„Ù„ØºØ© */;">
                        <!-- Ø²Ø± Ø§Ù„Ø¹Ø±Ø¶ - Ø§Ù„Ø¢Ù† ÙŠØ³ØªØ®Ø¯Ù… ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© -->
                        <button class="action-btn view-btn" onclick="viewImageFullscreen('${url}', '${title}')" title="Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-eye"></i>
                        </button>
                        
                        <!-- Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ -->
                        <button class="action-btn like-btn ${hasLiked ? 'active' : ''}" data-url="${url}" onclick="toggleLike('${url}', this)" title="Ø¥Ø¹Ø¬Ø§Ø¨" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-heart" style="${hasLiked ? 'color: white; -webkit-text-stroke: 0;' : 'color: transparent; -webkit-text-stroke: 1px white;'}"></i>
                        </button>
                        
                        <!-- Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª -->
                        <span class="like-count" style="background-color: rgba(58, 16, 69, 0.9); color: white; border-radius: 20px; padding: 0 12px; display: flex; align-items: center; justify-content: center; height: 30px; min-width: 35px; text-align: center;">${likesCount}</span>
                        
                        <!-- Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
                        <button class="action-btn share-btn" onclick="shareImage('${url}', '${title}')" title="Ù…Ø´Ø§Ø±ÙƒØ©" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-share-alt"></i>
                        </button>
                        
                        <!-- Ø²Ø± Ø§Ù„ØªÙ†Ø²ÙŠÙ„ -->
                        <button class="action-btn download-btn" onclick="window.downloadImage(event, '${url}')" title="ØªÙ†Ø²ÙŠÙ„" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-download"></i>
                        </button>
                        
                        <!-- Ø²Ø± ØªØ¹ÙŠÙŠÙ† ÙƒØµÙˆØ±Ø© Ù…Ù„Ù Ø´Ø®ØµÙŠ -->
                        <button class="action-btn profile-btn" onclick="setProfileImage('${url}')" title="ØªØ¹ÙŠÙŠÙ† ÙƒØµÙˆØ±Ø© Ù…Ù„Ù Ø´Ø®ØµÙŠ" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-user"></i>
                        </button>
                        
                        <!-- Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø© -->
                        <button class="action-btn favorite-btn ${isFavorite ? 'active' : ''}" data-url="${url}" onclick="toggleFavorite('${url}', this)" title="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©" style="background-color: rgba(58, 16, 69, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                            <i class="fas fa-bookmark" style="${isFavorite ? 'color: white; -webkit-text-stroke: 0;' : 'color: transparent; -webkit-text-stroke: 1px white;'}"></i>
                        </button>
                    </div>
                </div>
            `;
            
            // Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø£Ø²Ø±Ø§Ø± Ø³ÙÙ„ÙŠØ© Ù…Ù†ÙØµÙ„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¢Ù† Ù„Ø£Ù†Ù†Ø§ ÙˆØ¶Ø¹Ù†Ø§Ù‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© Ø£Ø³ÙÙ„ Ø§Ù„ØµÙˆØ±Ø©
            
            document.body.appendChild(viewer);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶
            viewer.querySelector('.close-btn').addEventListener('click', function() {
                viewer.remove();
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙˆØ±Ø©
            viewer.addEventListener('click', function(e) {
                if (e.target === viewer) {
                    viewer.remove();
                }
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Escape
            document.addEventListener('keydown', function escapeFn(e) {
                if (e.key === 'Escape') {
                    viewer.remove();
                    document.removeEventListener('keydown', escapeFn); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø¹
                }
            });
            
            // Ù„Ù… Ù†Ø¹Ø¯ Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø£Ø­Ø¯Ø§Ø« Ù…Ø®ØµØµØ© Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            // Ù„Ø£Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø± ØªØ­ØªÙˆÙŠ Ø¨Ø§Ù„ÙØ¹Ù„ Ø¹Ù„Ù‰ onclick ÙŠØªØ¶Ù…Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
        }
        
        /**
         * ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© Ù…Ø¹ Ø²Ø± Ø®Ø±ÙˆØ¬ ÙÙ‚Ø·
         * @param {string} url - Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
         * @param {string} title - Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø©
         */
        function viewImageFullscreen(url, title) {
            const viewer = document.createElement('div');
            viewer.className = 'pure-fullscreen-viewer';
            viewer.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.9); display: flex; justify-content: center; align-items: center; z-index: 10000;';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
            viewer.innerHTML = `
                <button class="close-btn" style="position: fixed; top: 20px; right: 20px; background-color: rgba(0,0,0,0.7); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 9999;">
                    <i class="fas fa-times"></i>
                </button>
                
                <img src="${url}" alt="${title}" style="max-width: 95%; max-height: 95vh; object-fit: contain; border-radius: 4px; box-shadow: 0 5px 25px rgba(0,0,0,0.5);" />
            `;
            
            document.body.appendChild(viewer);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶
            viewer.querySelector('.close-btn').addEventListener('click', function() {
                viewer.remove();
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙˆØ±Ø©
            viewer.addEventListener('click', function(e) {
                if (e.target === viewer) {
                    viewer.remove();
                }
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Escape
            document.addEventListener('keydown', function escapeFn(e) {
                if (e.key === 'Escape') {
                    viewer.remove();
                    document.removeEventListener('keydown', escapeFn); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø¹
                }
            });
        }
        
        // ÙˆØ¸ÙŠÙØ© Ø¯Ø§Ø®Ù„ÙŠØ© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù…Ù† URL
        function getFilenameFromUrl(url) {
            try {
                const urlObj = new URL(url);
                const pathname = urlObj.pathname;
                const segments = pathname.split('/');
                const filename = segments[segments.length - 1];
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
                return filename.split('?')[0] || 'image.jpg';
            } catch (e) {
                // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ØŒ Ù†Ø±Ø¬Ø¹ Ø§Ø³Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ
                return 'image.jpg';
            }
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function recordViewStats() {
            if (typeof recordImageView === 'function') {
                recordImageView();
            }
        }
        
        // Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© getFileNameFromUrl Ù„Ø¯Ø¹Ù… Ø§Ù„ØªÙ†Ø²ÙŠÙ„
        if (typeof window.getFilenameFromUrl !== 'function') {
            window.getFilenameFromUrl = function(url) {
                try {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
                    let filename = url.split('/').pop().split(/[?#]/)[0];
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù…ØªØ¯Ø§Ø¯ ØµØ§Ù„Ø­
                    const validExtensions = ['.png', '.jpg', '.jpeg', '.gif', '.webp'];
                    const hasValidExtension = validExtensions.some(ext => 
                      filename.toLowerCase().includes(ext)
                    );
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù…ØªØ¯Ø§Ø¯ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                    if (!hasValidExtension) {
                      if (url.includes('.png') || url.includes('png=')) {
                        filename += '.png';
                      } else if (url.includes('.gif') || url.includes('gif=')) {
                        filename += '.gif';
                      } else if (url.includes('.webp') || url.includes('webp=')) {
                        filename += '.webp';
                      } else {
                        filename += '.jpg'; // Ø§ÙØªØ±Ø§Ø¶ÙŠ
                      }
                    }
                    
                    // ØªÙ†Ù‚ÙŠØ© Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø§Ù„Ø£Ø­Ø±Ù ØºÙŠØ± Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
                    filename = filename.replace(/[^a-z0-9_.-]/gi, '_');
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
                    if (!filename || filename.length < 3 || filename === '.jpg' || filename === '_.jpg') {
                      const timestamp = Date.now();
                      const typeHint = url.includes('leonardo.ai') ? 'leonardo_' : 'image_';
                      filename = `${typeHint}${timestamp}.jpg`;
                    }
                    
                    return filename;
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:', e);
                    return `image_${Date.now()}.jpg`;
                }
            };
        }
        
        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„ØªÙ†Ø²ÙŠÙ„ ÙÙŠ Ø­Ø§Ù„ ÙØ´Ù„ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ù† ImageDownloader.js
        if (typeof window.downloadImage !== 'function') {
            window.downloadImage = function(event, url) {
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                console.log('Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©');
                
                try {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù…Ù† URL
                    const filename = window.getFilenameFromUrl ? window.getFilenameFromUrl(url) : url.substring(url.lastIndexOf('/') + 1);
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø§Ø¨Ø·
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ù‚Ø±
                    document.body.appendChild(link);
                    link.click();
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø²ÙŠÙ„
                    setTimeout(() => {
                        document.body.removeChild(link);
                    }, 100);
                    
                    // ØªØ³Ø¬ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙ†Ø²ÙŠÙ„
                    if (typeof recordImageDownload === 'function') {
                        recordImageDownload();
                    }
                    
                    return true;
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©:', error);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹.');
                    return false;
                }
            };
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¨Ø³ÙŠØ·
        function initSearch() {
            const searchInput = document.getElementById('searchInput');
            
            if (searchInput) {
                // Ù…Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.trim().toLowerCase();
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø«
                    searchGallery(searchTerm);
                });
                
                // Ù…Ø³ØªÙ…Ø¹ Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø­Ø«
                const searchIcon = document.querySelector('.search-icon');
                if (searchIcon) {
                    searchIcon.addEventListener('click', function() {
                        searchInput.focus();
                    });
                }
            }
        }
        
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶
        function searchGallery(searchTerm) {
            console.log('Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†:', searchTerm);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø±Ø¨Ø· Ø§Ù„Ø¨Ø­Ø« Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª
            const isLinked = window.isSearchLinked ? window.isSearchLinked() : true;
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØµØ·Ù„Ø­ Ø§Ù„Ø¨Ø­Ø« ÙØ§Ø±ØºÙ‹Ø§ØŒ Ø§Ø³ØªØ¹Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± ÙˆØ·Ø¨Ù‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            if (!searchTerm) {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
                window.searchFilter = null;
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                applyFilters();
                refreshMasonry();
                return;
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
            if (!window.hiddenItems) {
                window.hiddenItems = new Set();
            }
            
            // Ø­ÙØ¸ ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ ÙˆØ¸Ø§Ø¦Ù Ø£Ø®Ø±Ù‰
            window.searchFilter = searchTerm;
            
            const gridItems = document.querySelectorAll('.grid-item');
            let found = false;
            
            gridItems.forEach(item => {
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ±
                const itemId = item.getAttribute('data-id') || item.id || item.dataset.url || Math.random().toString(36).substring(2, 15);
                
                // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ù…Ø¹Ø±Ù
                if (!item.getAttribute('data-id')) {
                    item.setAttribute('data-id', itemId);
                }
                
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¨Ø­Ø«
                const title = item.getAttribute('data-title')?.toLowerCase() || '';
                const category = item.getAttribute('data-category')?.toLowerCase() || '';
                const tags = item.getAttribute('data-tags')?.toLowerCase() || '';
                
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø©
                const titleElement = item.querySelector('.image-title-badge');
                const titleText = titleElement ? titleElement.textContent.toLowerCase() : '';
                
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙØ¦Ø© Ø§Ù„ØµÙˆØ±Ø©
                const categoryElement = item.querySelector('.category-badge');
                const categoryText = categoryElement ? categoryElement.textContent.toLowerCase() : '';
                
                // Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù†ØµÙˆØµ Ù„Ù„Ø¨Ø­Ø« ÙÙŠÙ‡Ø§
                const searchableText = `${title} ${category} ${tags} ${titleText} ${categoryText}`;
                
                const match = searchableText.includes(searchTerm);
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
                let categoryMatch = true;
                let dimensionMatch = true;
                
                // ÙØ­Øµ Ù…Ø±Ø´Ø­ Ø§Ù„ÙØ¦Ø© (ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø¨Ø· Ù…ÙØ¹Ù„)
                if (isLinked && window.currentCategoryFilter && window.currentCategoryFilter !== 'all') {
                    categoryMatch = category === window.currentCategoryFilter;
                }
                
                // ÙØ­Øµ Ù…Ø±Ø´Ø­ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Ø¯Ø§Ø¦Ù…Ø§Ù‹ - Ø³ÙˆØ§Ø¡ ÙƒØ§Ù† Ø§Ù„Ø±Ø¨Ø· Ù…ÙØ¹Ù„ Ø£Ùˆ Ù…Ø·ÙØ¦)
                if (window.currentDimensionFilter && window.currentDimensionFilter !== 'all') {
                    const itemDimension = item.getAttribute('data-dimension') || '';
                    dimensionMatch = itemDimension === window.currentDimensionFilter;
                }
                
                // Ø§Ù„Ø¹Ù†ØµØ± ÙŠØ¸Ù‡Ø± Ø¥Ø°Ø§ ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ø¨Ø­Ø« ÙˆØ£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø©ØŒ ÙˆÙ…Ø¹ Ø§Ù„ÙØ¦Ø© ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø¨Ø· Ù…ÙØ¹Ù„
                const shouldShow = match && dimensionMatch && categoryMatch;
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ©
                if (shouldShow) {
                    found = true;
                    window.hiddenItems.delete(itemId);
                    applyItemVisibility(item, true);
                } else {
                    window.hiddenItems.add(itemId);
                    applyItemVisibility(item, false);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ØªØ®Ø·ÙŠØ· Masonry
            refreshMasonry();
        }
        
        // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù„Ù„Ø¨Ø­Ø«
        initSearch();
        
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        updateSearchPlaceholder();
        
        // ÙˆØ¸ÙŠÙØ© Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ÙÙ„Ø§ØªØ± (Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ)
        function restoreViewMode() {
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙØ¶Ù„
            const savedViewMode = localStorage.getItem('viewMode') || 'default';
            
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ÙØ¶Ù„Ø©
            window.currentCategoryFilter = localStorage.getItem('currentCategoryFilter') || 'all';
            window.currentDimensionFilter = localStorage.getItem('currentDimensionFilter') || 'all';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ©
            if (!window.hiddenItems) {
                window.hiddenItems = new Set();
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ - Ù…Ø¹ ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„
            setTimeout(() => {
                // ØªØ·Ø¨ÙŠÙ‚ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶
                setGridColumns(savedViewMode);
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù†Ø´Ø·Ø©
                try {
                    // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    const categoryBtn = document.querySelector(`.filter-btn[data-category="${window.currentCategoryFilter}"]`);
                    if (categoryBtn) categoryBtn.classList.add('active');
                    
                    // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
                    document.querySelectorAll('.dimension-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    const dimensionBtn = document.querySelector(`.dimension-btn[data-dimension="${window.currentDimensionFilter}"]`);
                    if (dimensionBtn) dimensionBtn.classList.add('active');
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„Ø§ØªØ±:', e);
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
                applyFilters();
                
                // ØªØ£ÙƒÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµØ­ÙŠØ­ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø£Ø·ÙˆÙ„
                setTimeout(() => {
                    refreshMasonry();
                }, 300);
            }, 200);
        }
        
        /**
         * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø© (Ø·ÙˆÙ„ÙŠØŒ Ø¹Ø±Ø¶ÙŠØŒ Ù…Ø±Ø¨Ø¹)
         * @param {HTMLImageElement} img - Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø©
         * @returns {string} Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¹Ø¯ ('portrait', 'landscape', 'square')
         */
        function getImageDimensionType(img) {
            const width = img.naturalWidth || img.width || 0;
            const height = img.naturalHeight || img.height || 0;
            
            if (width && height) {
                const ratio = width / height;
                
                if (ratio < 0.9) {
                    return 'portrait';  // Ø·ÙˆÙ„ÙŠ
                } else if (ratio > 1.1) {
                    return 'landscape'; // Ø¹Ø±Ø¶ÙŠ
                } else {
                    return 'square';   // Ù…Ø±Ø¨Ø¹
                }
            }
            
            return 'square'; // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
        }
        
        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ø³Ù…Ø© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶
        function setDimensionAttributesForAllImages() {
            console.log("Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±...");
            const gridItems = document.querySelectorAll('.grid-item');
            gridItems.forEach(item => {
                if (!item.hasAttribute('data-dimension')) {
                    const img = item.querySelector('img');
                    if (img && img.complete) {
                        const dimension = getImageDimensionType(img);
                        item.setAttribute('data-dimension', dimension);
                        console.log("ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ Ø§Ù„ØµÙˆØ±Ø©:", img.alt || 'ØµÙˆØ±Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†', dimension);
                    } else if (img) {
                        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„ØµÙˆØ±Ø© Ù…Ø­Ù…Ù„Ø©ØŒ Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ØªÙƒØªÙ…Ù„
                        img.onload = function() {
                            const dimension = getImageDimensionType(img);
                            item.setAttribute('data-dimension', dimension);
                            console.log("ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„:", img.alt || 'ØµÙˆØ±Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†', dimension);
                        };
                    }
                }
            });
        }
        
        /**
         * ØªØ­Ø¯ÙŠØ« Ù…Ø¸Ù‡Ø± Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
         */
        function updateWideViewButtonState() {
            const wideViewBtn = document.getElementById('wideViewBtn');
            const disabledIcon = wideViewBtn ? wideViewBtn.querySelector('.mobile-disabled-icon') : null;
            
            if (!wideViewBtn || !disabledIcon) return;
            
            const screenWidth = window.innerWidth;
            
            if (screenWidth <= 768) {
                // ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©: Ø¥Ø¸Ù‡Ø§Ø± Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ¹Ø·ÙŠÙ„ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù… Ù…Ø¹ Ø®Ù„ÙÙŠØ© Ø¨Ø§Ù‡ØªØ©
                disabledIcon.style.display = 'block';
                disabledIcon.style.color = '#ff6b6b'; // Ù„ÙˆÙ† Ø²Ø§Ù‡ÙŠ Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
                disabledIcon.style.opacity = '1'; // ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ÙƒØ§Ù…Ù„
                wideViewBtn.style.backgroundColor = 'rgba(255, 255, 255, 0.1)'; // Ø®Ù„ÙÙŠØ© Ø¨Ø§Ù‡ØªØ©
                wideViewBtn.style.opacity = '0.5';
                wideViewBtn.style.cursor = 'not-allowed';
                wideViewBtn.classList.add('disabled-mobile');
            } else {
                // ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© ÙˆØ§Ù„ÙƒØ¨ÙŠØ±Ø©: Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ¹Ø·ÙŠÙ„ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±
                disabledIcon.style.display = 'none';
                wideViewBtn.style.backgroundColor = ''; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©
                wideViewBtn.style.opacity = '1';
                wideViewBtn.style.cursor = 'pointer';
                wideViewBtn.classList.remove('disabled-mobile');
            }
        }

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            restoreViewMode();
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶
            updateWideViewButtonState();
            
            // ØªØ­Ø¯ÙŠØ¯ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ± Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            setTimeout(setDimensionAttributesForAllImages, 1000);
        });
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±ÙŠØ¶ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
        window.addEventListener('resize', function() {
            updateWideViewButtonState();
        });
        
        /**
         * ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
         */
        function updateAuthUI() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const userInfo = document.getElementById('user-info');
            const userName = document.getElementById('user-name');
            const userEmail = document.getElementById('user-email');
            
            if (currentUser && currentUser.username) {
                userName.textContent = currentUser.username;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªÙˆÙØ±Ù‹Ø§
                if (currentUser.email) {
                    userEmail.textContent = currentUser.email;
                } else {
                    userEmail.textContent = 'user@example.com';
                }
                
                // ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©
                const userAvatar = document.getElementById('user-avatar');
                const savedAvatar = localStorage.getItem('userAvatar');
                if (savedAvatar) {
                    userAvatar.src = savedAvatar;
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                updateUserStats();
            } else {
                userName.textContent = 'Ø²Ø§Ø¦Ø±';
                userEmail.textContent = 'guest@example.com';
            }
        }
        
        /**
         * ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
         */
        function toggleUserMenu() {
            const dropdown = document.getElementById('user-dropdown-menu');
            const icon = document.getElementById('user-dropdown-icon');
            
            if (dropdown.style.display === 'none' || !dropdown.style.display) {
                dropdown.style.display = 'block';
                icon.style.transform = 'rotate(180deg)';
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¥ØºÙ„Ø§Ù‚Ù‡Ø§
                setTimeout(() => {
                    document.addEventListener('click', closeUserMenuOnClickOutside);
                }, 10);
            } else {
                dropdown.style.display = 'none';
                icon.style.transform = 'rotate(0)';
                document.removeEventListener('click', closeUserMenuOnClickOutside);
            }
        }
        
        /**
         * Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
         */
        function closeUserMenuOnClickOutside(event) {
            const userInfo = document.getElementById('user-info');
            const dropdown = document.getElementById('user-dropdown-menu');
            
            if (!userInfo.contains(event.target)) {
                dropdown.style.display = 'none';
                document.getElementById('user-dropdown-icon').style.transform = 'rotate(0)';
                document.removeEventListener('click', closeUserMenuOnClickOutside);
            }
        }
        
        /**
         * ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø¨
         */
        function logout() {
            // Ø¥Ø²Ø§Ù„Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            localStorage.removeItem('currentUser');
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            updateAuthUI();
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            window.location.href = 'simple-gallery.html';
        }
        
        /**
         * ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
         */
        function updateUILanguage() {
            const currentLang = localStorage.getItem('language') || 'ar';
            
            // Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ­Ø¯
            const translations = {
                settings: { ar: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', en: 'Settings' },
                logout: { ar: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', en: 'Logout' },
                favCount: { ar: 'Ù…ÙØ¶Ù„Ø©', en: 'Favorites' },
                likeCount: { ar: 'Ø¥Ø¹Ø¬Ø§Ø¨', en: 'Likes' },
                myAccount: { ar: 'Ø­Ø³Ø§Ø¨ÙŠ', en: 'My Account' },
                home: { ar: 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', en: 'Home' },
                myProfile: { ar: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', en: 'My Profile' },
                myFavorites: { ar: 'Ø§Ù„Ù…ÙØ¶Ù„Ø©', en: 'My Favorites' },
                language: { ar: 'Ø§Ù„Ù„ØºØ©', en: 'Language' },
                imageDimensions: { ar: 'Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±', en: 'Image Dimensions' },
                viewMode: { ar: 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶', en: 'View Mode' },
                tools: { ar: 'Ø£Ø¯ÙˆØ§Øª', en: 'Tools' },
                // ØªØ±Ø¬Ù…Ø§Øª Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª
                allImages: { ar: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±', en: 'All Images' },
                animals: { ar: 'Ø­ÙŠÙˆØ§Ù†Ø§Øª', en: 'Animals' },
                anime: { ar: 'Ø£Ù†Ù…ÙŠ', en: 'Anime' },
                creativity: { ar: 'Ø¥Ø¨Ø¯Ø§Ø¹', en: 'Creativity' },
                technology: { ar: 'ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§', en: 'Technology' },
                world: { ar: 'Ø¹Ø§Ù„Ù…', en: 'World' },
                space: { ar: 'ÙØ¶Ø§Ø¡', en: 'Space' },
                classic: { ar: 'ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ', en: 'Classic' }
            };
            
            // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø³Ù…Ø© data-i18n
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[key] && translations[key][currentLang]) {
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù†ØµØ± category-text Ø¨Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹Ù†ØµØ± (Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø±ÙƒØ¨Ø©)
                    const categoryTextElement = element.querySelector('.category-text');
                    if (categoryTextElement) {
                        categoryTextElement.textContent = translations[key][currentLang];
                    } else {
                        // Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
                        element.textContent = translations[key][currentLang];
                    }
                }
            });
        }

        /**
         * ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ù…Ø¹ ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„ Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
         */
        function switchLanguage(lang) {
            console.log('ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰:', lang);
            
            // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù„ØºØ©
            localStorage.setItem('language', lang);
            
            // ØªØ­Ø¯ÙŠØ« Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„ØºØ©
            document.querySelectorAll('.lang-option').forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('data-lang') === lang) {
                    option.classList.add('active');
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ÙƒØ±ÙˆØª Ø§Ù„ØµÙˆØ± Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
            updateImageCardsLanguage();
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª ÙÙˆØ±Ø§Ù‹
            updateUILanguage();
        }

        /**
         * ØªØ­Ø¯ÙŠØ« ÙƒØ±ÙˆØª Ø§Ù„ØµÙˆØ± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
         */
        function updateImageCardsLanguage() {
            const currentLang = localStorage.getItem('language') || 'ar';
            const gridItems = document.querySelectorAll('.grid-item');
            
            gridItems.forEach((item, index) => {
                // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø©
                const imageData = window.imageData[index];
                if (!imageData) return;
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙˆØ±Ø©
                const titleElement = item.querySelector('.image-title-badge');
                if (titleElement && imageData.title) {
                    let newTitle;
                    if (typeof imageData.title === 'object') {
                        newTitle = imageData.title[currentLang] || 
                                  imageData.title.ar || 
                                  imageData.title.en || 
                                  imageData.alt || 
                                  'ØµÙˆØ±Ø©';
                    } else {
                        newTitle = imageData.title || imageData.alt || 'ØµÙˆØ±Ø©';
                    }
                    titleElement.textContent = newTitle;
                    titleElement.title = newTitle;
                }
                
                // ØªØ­Ø¯ÙŠØ« ÙØ¦Ø© Ø§Ù„ØµÙˆØ±Ø©
                const categoryElement = item.querySelector('.category-badge');
                if (categoryElement && imageData.category) {
                    let newCategory;
                    if (typeof imageData.category === 'object') {
                        newCategory = imageData.category[currentLang] || 
                                     imageData.category.ar || 
                                     imageData.category.en || 
                                     imageData.category;
                    } else {
                        // ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                        const categoryTranslations = {
                            'creativity': currentLang === 'ar' ? 'Ø¥Ø¨Ø¯Ø§Ø¹' : 'Creativity',
                            'animals': currentLang === 'ar' ? 'Ø­ÙŠÙˆØ§Ù†Ø§Øª' : 'Animals',
                            'space': currentLang === 'ar' ? 'ÙØ¶Ø§Ø¡' : 'Space',
                            'technology': currentLang === 'ar' ? 'ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§' : 'Technology',
                            'nature': currentLang === 'ar' ? 'Ø·Ø¨ÙŠØ¹Ø©' : 'Nature',
                            'anime': currentLang === 'ar' ? 'Ø£Ù†Ù…ÙŠ' : 'Anime',
                            'world': currentLang === 'ar' ? 'Ø¹Ø§Ù„Ù…' : 'World',
                            'classic': currentLang === 'ar' ? 'ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ' : 'Classic',
                            'birds': currentLang === 'ar' ? 'Ø·ÙŠÙˆØ±' : 'Birds',
                            'general': currentLang === 'ar' ? 'Ø¹Ø§Ù…' : 'General'
                        };
                        
                        const categoryLower = imageData.category.toLowerCase();
                        newCategory = categoryTranslations[categoryLower] || imageData.category;
                    }
                    categoryElement.textContent = newCategory;
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø«
            updateSearchPlaceholder();
        }

        /**
         * ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
         */
        function updateSearchPlaceholder() {
            const currentLang = localStorage.getItem('language') || 'ar';
            const searchInput = document.getElementById('searchInput');
            
            if (searchInput) {
                const placeholderTexts = {
                    'ar': 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… ØµÙˆØ±Ø©...',
                    'en': 'Search for image name...'
                };
                
                searchInput.placeholder = placeholderTexts[currentLang] || placeholderTexts['ar'];
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            const standardMenu = document.getElementById('languageMenu');
            const indexMenu = document.getElementById('indexLanguageMenu');
            
            if (standardMenu) {
                standardMenu.classList.remove('show');
                standardMenu.style.display = 'none';
            }
            
            if (indexMenu) {
                indexMenu.style.display = 'none';
            }
            
            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
            if (typeof window.updateUILanguage === 'function' && window.updateUILanguage !== updateUILanguage) {
                try {
                    window.updateUILanguage();
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©:', e);
                }
            }
        }

        /**
         * ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
         */
        function openSettings() {
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
            const dropdown = document.getElementById('user-dropdown-menu');
            if (dropdown && dropdown.style.display === 'block') {
                toggleUserMenu();
            }
            
            // Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            showSettingsDialog();
        }
        
        /**
         * Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
         */
        function showSettingsDialog() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const currentLang = localStorage.getItem('language') || 'ar';
            const isRTL = currentLang === 'ar';
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
            const texts = currentLang === 'en' ? {
                title: 'Settings',
                user: 'User',
                account: 'Account',
                username: 'Username',
                save: 'Save Changes',
                logout: 'Logout',
                deleteAccount: 'Delete Account',
                deleteConfirm: 'Are you sure you want to delete your account?',
                yes: 'Yes',
                no: 'No',
                close: 'Close'
            } : {
                title: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª',
                user: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
                account: 'Ø§Ù„Ø­Ø³Ø§Ø¨',
                username: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
                save: 'Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª',
                logout: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
                deleteAccount: 'Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨',
                deleteConfirm: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ø­Ø³Ø§Ø¨ÙƒØŸ',
                yes: 'Ù†Ø¹Ù…',
                no: 'Ù„Ø§',
                close: 'Ø¥ØºÙ„Ø§Ù‚'
            };
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const username = currentUser.username || 'Ø²Ø§Ø¦Ø±';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø®Ù„ÙÙŠØ©
            const settingsOverlay = document.createElement('div');
            settingsOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                backdrop-filter: blur(4px);
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            const settingsBox = document.createElement('div');
            settingsBox.style.cssText = `
                background: linear-gradient(135deg, rgba(20, 20, 35, 0.98), rgba(35, 35, 50, 0.98));
                border: 2px solid rgba(100, 100, 150, 0.4);
                border-radius: 20px;
                width: 90%;
                max-width: 500px;
                max-height: 80vh;
                overflow-y: auto;
                overflow-x: hidden;
                text-align: center;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
                direction: ltr;
                position: relative;
                backdrop-filter: blur(15px);
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø£Ø³ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø­ÙˆØ§Ø± Ù…Ø¹ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (Ø«Ø§Ø¨Øª ÙˆÙ„Ø§ ÙŠØªØ£Ø«Ø± Ø¨ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©)
            const header = document.createElement('div');
            header.style.cssText = `
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 25px 30px;
                border-bottom: 2px solid rgba(80, 80, 120, 0.4);
                background: linear-gradient(90deg, rgba(50, 50, 70, 0.2), rgba(60, 60, 80, 0.2));
                border-radius: 20px 20px 0 0;
                position: sticky;
                top: 0;
                z-index: 10;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø«Ø§Ø¨Øª ÙˆÙ„Ø§ ÙŠØªØ£Ø«Ø± Ø¨ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©)
            const title = document.createElement('h2');
            title.textContent = texts.title;
            title.style.cssText = `
                color: #b0c4ff;
                margin: 0;
                font-size: 26px;
                font-weight: bold;
                text-shadow: 0 2px 8px rgba(176, 196, 255, 0.4);
                position: relative;
                z-index: 1;
            `;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (X)
            const closeX = document.createElement('button');
            closeX.innerHTML = '&times;';
            closeX.style.cssText = `
                background: none;
                border: none;
                color: rgba(255, 255, 255, 0.7);
                font-size: 28px;
                cursor: pointer;
                padding: 0;
                width: 30px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: color 0.3s;
            `;
            
            closeX.addEventListener('mouseenter', () => {
                closeX.style.color = 'white';
            });
            
            closeX.addEventListener('mouseleave', () => {
                closeX.style.color = 'rgba(255, 255, 255, 0.7)';
            });
            
            closeX.addEventListener('click', () => {
                document.body.removeChild(settingsOverlay);
            });
            
            header.appendChild(title);
            header.appendChild(closeX);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø³Ù… Ø§Ù„ØªÙ†Ù‚Ù„ (Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨ÙŠØ©)
            const tabsContainer = document.createElement('div');
            tabsContainer.style.cssText = `
                display: flex;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                padding: 0 25px;
            `;
            
            const tabs = [
                { id: 'user-tab', text: texts.user, active: true },
                { id: 'account-tab', text: texts.account, active: false }
            ];
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨ÙŠØ©
            tabs.forEach(tab => {
                const tabElement = document.createElement('div');
                tabElement.id = tab.id;
                tabElement.textContent = tab.text;
                tabElement.style.cssText = `
                    padding: 15px 20px;
                    color: ${tab.active ? 'white' : 'rgba(255, 255, 255, 0.7)'};
                    cursor: pointer;
                    position: relative;
                    font-weight: ${tab.active ? 'bold' : 'normal'};
                    transition: color 0.3s;
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ù„Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
                if (tab.active) {
                    tabElement.style.cssText += `
                        &::after {
                            content: '';
                            position: absolute;
                            bottom: -1px;
                            left: 0;
                            width: 100%;
                            height: 3px;
                            background: linear-gradient(to right, #b44ccc, #9966ff);
                            border-radius: 3px 3px 0 0;
                        }
                    `;
                }
                
                // Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù†Ù‚Ø± Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª
                tabElement.addEventListener('click', () => {
                    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
                    if (tab.id === 'user-tab') {
                        document.getElementById('user-content').style.display = 'block';
                        document.getElementById('account-content').style.display = 'none';
                        document.getElementById('user-tab').style.color = 'white';
                        document.getElementById('user-tab').style.fontWeight = 'bold';
                        document.getElementById('account-tab').style.color = 'rgba(255, 255, 255, 0.7)';
                        document.getElementById('account-tab').style.fontWeight = 'normal';
                    } else {
                        document.getElementById('user-content').style.display = 'none';
                        document.getElementById('account-content').style.display = 'block';
                        document.getElementById('account-tab').style.color = 'white';
                        document.getElementById('account-tab').style.fontWeight = 'bold';
                        document.getElementById('user-tab').style.color = 'rgba(255, 255, 255, 0.7)';
                        document.getElementById('user-tab').style.fontWeight = 'normal';
                    }
                });
                
                tabsContainer.appendChild(tabElement);
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const userContent = document.createElement('div');
            userContent.id = 'user-content';
            userContent.style.cssText = `
                padding: 25px;
                display: block;
            `;
            
            // Ø­Ù‚Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const usernameField = document.createElement('div');
            usernameField.style.cssText = `
                margin-bottom: 20px;
            `;
            
            const usernameLabel = document.createElement('label');
            usernameLabel.textContent = texts.username;
            usernameLabel.style.cssText = `
                display: block;
                margin-bottom: 8px;
                color: rgba(255, 255, 255, 0.9);
                font-size: 14px;
            `;
            
            const usernameInput = document.createElement('input');
            usernameInput.type = 'text';
            usernameInput.value = username;
            usernameInput.id = 'username-input';
            usernameInput.style.cssText = `
                width: 100%;
                padding: 12px 15px;
                background: rgba(0, 0, 0, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.15);
                border-radius: 8px;
                color: white;
                font-size: 16px;
                box-sizing: border-box;
                transition: border-color 0.3s;
            `;
            
            usernameInput.addEventListener('focus', () => {
                usernameInput.style.borderColor = 'rgba(180, 76, 204, 0.5)';
            });
            
            usernameInput.addEventListener('blur', () => {
                usernameInput.style.borderColor = 'rgba(255, 255, 255, 0.15)';
            });
            
            usernameField.appendChild(usernameLabel);
            usernameField.appendChild(usernameInput);
            
            // Ø²Ø± Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            const saveButton = document.createElement('button');
            saveButton.textContent = texts.save;
            saveButton.style.cssText = `
                background: linear-gradient(45deg, #9c65a3, #ba7fc2);
                color: white;
                border: none;
                border-radius: 8px;
                padding: 12px 15px;
                font-size: 16px;
                width: 100%;
                cursor: pointer;
                transition: all 0.3s;
            `;
            
            saveButton.addEventListener('mouseenter', () => {
                saveButton.style.background = 'linear-gradient(45deg, #b279b9, #c98dd1)';
            });
            
            saveButton.addEventListener('mouseleave', () => {
                saveButton.style.background = 'linear-gradient(45deg, #9c65a3, #ba7fc2)';
            });
            
            saveButton.addEventListener('click', () => {
                const newUsername = document.getElementById('username-input').value.trim();
                
                if (newUsername) {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
                    const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    user.username = newUsername;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    
                    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    document.getElementById('user-name').textContent = newUsername;
                    
                    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                    const successMsg = document.createElement('div');
                    successMsg.textContent = currentLang === 'en' ? 'Username updated successfully!' : 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!';
                    successMsg.style.cssText = `
                        color: #4caf50;
                        background: rgba(76, 175, 80, 0.1);
                        padding: 10px;
                        border-radius: 5px;
                        margin-top: 10px;
                        text-align: center;
                    `;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ¥Ø²Ø§Ù„ØªÙ‡Ø§ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
                    if (!document.getElementById('success-message')) {
                        successMsg.id = 'success-message';
                        userContent.appendChild(successMsg);
                        
                        setTimeout(() => {
                            if (document.getElementById('success-message')) {
                                userContent.removeChild(successMsg);
                            }
                        }, 3000);
                    }
                }
            });
            
            userContent.appendChild(usernameField);
            userContent.appendChild(saveButton);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨
            const accountContent = document.createElement('div');
            accountContent.id = 'account-content';
            accountContent.style.cssText = `
                padding: 25px;
                display: none;
            `;
            
            // Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            const logoutButton = document.createElement('button');
            logoutButton.textContent = texts.logout;
            logoutButton.style.cssText = `
                background: rgba(0, 0, 0, 0.3);
                color: white;
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 8px;
                padding: 12px 15px;
                font-size: 16px;
                width: 100%;
                cursor: pointer;
                margin-bottom: 15px;
                transition: all 0.3s;
                text-align: center;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            // Ø£ÙŠÙ‚ÙˆÙ†Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            const logoutIcon = document.createElement('i');
            logoutIcon.className = 'fas fa-sign-out-alt';
            logoutIcon.style.cssText = `
                margin-${isRTL ? 'left' : 'right'}: 10px;
                font-size: 16px;
            `;
            
            logoutButton.prepend(logoutIcon);
            
            logoutButton.addEventListener('mouseenter', () => {
                logoutButton.style.background = 'rgba(0, 0, 0, 0.4)';
            });
            
            logoutButton.addEventListener('mouseleave', () => {
                logoutButton.style.background = 'rgba(0, 0, 0, 0.3)';
            });
            
            logoutButton.addEventListener('click', () => {
                logout();
            });
            
            // Ø²Ø± Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨
            const deleteButton = document.createElement('button');
            deleteButton.textContent = texts.deleteAccount;
            deleteButton.style.cssText = `
                background: rgba(244, 67, 54, 0.1);
                color: #f44336;
                border: 1px solid rgba(244, 67, 54, 0.3);
                border-radius: 8px;
                padding: 12px 15px;
                font-size: 16px;
                width: 100%;
                cursor: pointer;
                transition: all 0.3s;
                text-align: center;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨
            const deleteIcon = document.createElement('i');
            deleteIcon.className = 'fas fa-trash-alt';
            deleteIcon.style.cssText = `
                margin-${isRTL ? 'left' : 'right'}: 10px;
                font-size: 16px;
            `;
            
            deleteButton.prepend(deleteIcon);
            
            deleteButton.addEventListener('mouseenter', () => {
                deleteButton.style.background = 'rgba(244, 67, 54, 0.2)';
            });
            
            deleteButton.addEventListener('mouseleave', () => {
                deleteButton.style.background = 'rgba(244, 67, 54, 0.1)';
            });
            
            deleteButton.addEventListener('click', () => {
                // Ø¹Ø±Ø¶ Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
                if (confirm(texts.deleteConfirm)) {
                    // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    localStorage.removeItem('currentUser');
                    localStorage.removeItem('userAvatar');
                    localStorage.removeItem('favorites');
                    localStorage.removeItem('userLikes');
                    
                    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    updateAuthUI();
                    
                    // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    document.body.removeChild(settingsOverlay);
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    window.location.href = 'simple-gallery.html';
                }
            });
            
            accountContent.appendChild(logoutButton);
            accountContent.appendChild(deleteButton);
            
            // ØªØ¬Ù…ÙŠØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            settingsBox.appendChild(header);
            settingsBox.appendChild(tabsContainer);
            settingsBox.appendChild(userContent);
            settingsBox.appendChild(accountContent);
            
            settingsOverlay.appendChild(settingsBox);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            document.body.appendChild(settingsOverlay);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡
            settingsOverlay.addEventListener('click', (e) => {
                if (e.target === settingsOverlay) {
                    document.body.removeChild(settingsOverlay);
                }
            });
        }
        
        /**
         * ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
         */
        function updateUserStats() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙØ¶Ù„Ø©
            const favoritesElement = document.getElementById('favorites-count');
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            favoritesElement.textContent = favorites.length;
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª
            const likesElement = document.getElementById('likes-count');
            const userLikes = JSON.parse(localStorage.getItem('userLikes') || '[]');
            likesElement.textContent = userLikes.length;
        }
        
        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯ÙˆØ§Ù„ ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ø§Ù… Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§
        window.updateUILanguage = updateUILanguage;
        window.switchLanguage = switchLanguage;

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            updateAuthUI();
            updateUILanguage(); // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            const savedLang = localStorage.getItem('language') || 'ar';
            document.documentElement.dir = savedLang === 'ar' ? 'rtl' : 'ltr';
        });


    </script>
</body>
</html>